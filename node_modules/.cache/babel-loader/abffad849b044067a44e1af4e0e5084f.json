{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\n\nvar _react = _interopRequireWildcard(require(\"react\"));\n\nvar _propTypes = _interopRequireDefault(require(\"prop-types\"));\n\nvar _basicprimitives = _interopRequireDefault(require(\"basicprimitives\"));\n\nvar _Graphics = _interopRequireDefault(require(\"./Graphics\"));\n\nvar _Templates = require(\"./Templates\");\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nfunction _getRequireWildcardCache() {\n  if (typeof WeakMap !== \"function\") return null;\n  var cache = new WeakMap();\n\n  _getRequireWildcardCache = function _getRequireWildcardCache() {\n    return cache;\n  };\n\n  return cache;\n}\n\nfunction _interopRequireWildcard(obj) {\n  if (obj && obj.__esModule) {\n    return obj;\n  }\n\n  if (obj === null || _typeof(obj) !== \"object\" && typeof obj !== \"function\") {\n    return {\n      \"default\": obj\n    };\n  }\n\n  var cache = _getRequireWildcardCache();\n\n  if (cache && cache.has(obj)) {\n    return cache.get(obj);\n  }\n\n  var newObj = {};\n  var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;\n\n  for (var key in obj) {\n    if (Object.prototype.hasOwnProperty.call(obj, key)) {\n      var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;\n\n      if (desc && (desc.get || desc.set)) {\n        Object.defineProperty(newObj, key, desc);\n      } else {\n        newObj[key] = obj[key];\n      }\n    }\n  }\n\n  newObj[\"default\"] = obj;\n\n  if (cache) {\n    cache.set(obj, newObj);\n  }\n\n  return newObj;\n}\n\nfunction _typeof(obj) {\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nfunction _toConsumableArray(arr) {\n  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread();\n}\n\nfunction _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance\");\n}\n\nfunction _iterableToArray(iter) {\n  if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === \"[object Arguments]\") return Array.from(iter);\n}\n\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) {\n    for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) {\n      arr2[i] = arr[i];\n    }\n\n    return arr2;\n  }\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  }\n\n  return _assertThisInitialized(self);\n}\n\nfunction _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\n\nfunction _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) _setPrototypeOf(subClass, superClass);\n}\n\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nvar BaseDiagram =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(BaseDiagram, _Component);\n\n  function BaseDiagram(props, namespace) {\n    var _this;\n\n    _classCallCheck(this, BaseDiagram);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(BaseDiagram).call(this, props));\n    _this.namespace = namespace;\n    var config = props.config,\n        centerOnCursor = props.centerOnCursor;\n    var highlightItem = config.highlightItem,\n        cursorItem = config.cursorItem,\n        selectedItems = config.selectedItems;\n    _this.state = {\n      viewportSize: {\n        width: 0,\n        height: 0\n      },\n      contentPosition: {\n        x: 0,\n        y: 0\n      },\n      centerOnCursor: centerOnCursor,\n      highlightItem: highlightItem,\n      cursorItem: cursorItem,\n      selectedItems: (selectedItems || []).slice()\n    };\n    var viewportSize = _this.state.viewportSize;\n    _this.onRefreshViewport = _this.onRefreshViewport.bind(_assertThisInitialized(_this));\n    _this.onSizeChanged = _this.onSizeChanged.bind(_assertThisInitialized(_this));\n    _this.onScroll = _this.onScroll.bind(_assertThisInitialized(_this));\n    _this.onMouseMove = _this.onMouseMove.bind(_assertThisInitialized(_this));\n    _this.onClick = _this.onClick.bind(_assertThisInitialized(_this));\n    _this.onCheckboxChange = _this.onCheckboxChange.bind(_assertThisInitialized(_this));\n    _this.onKeyDown = _this.onKeyDown.bind(_assertThisInitialized(_this));\n    _this.getOptions = _this.getOptions.bind(_assertThisInitialized(_this));\n    _this.getGraphics = _this.getGraphics.bind(_assertThisInitialized(_this));\n    _this.getLayout = _this.getLayout.bind(_assertThisInitialized(_this));\n    _this.setLayout = _this.setLayout.bind(_assertThisInitialized(_this));\n    _this.getEventArgs = _this.getEventArgs.bind(_assertThisInitialized(_this));\n    _this.centerOnCursor = _this.centerOnCursor.bind(_assertThisInitialized(_this));\n    _this.onItemRender = _this.onItemRender.bind(_assertThisInitialized(_this));\n    _this.onHighlightRender = _this.onHighlightRender.bind(_assertThisInitialized(_this));\n    _this.onCursorRender = _this.onCursorRender.bind(_assertThisInitialized(_this));\n    _this.scrollPanelRef = _react[\"default\"].createRef();\n    _this.mousePanelRef = _react[\"default\"].createRef();\n    _this.placeholderRef = _react[\"default\"].createRef();\n    _this.calloutPlaceholderRef = _react[\"default\"].createRef();\n    _this.layoutOptions = {};\n    _this.templatesHash = {};\n    _this.graphics = new _Graphics[\"default\"](viewportSize);\n    _this.templates = {\n      AnnotationLabelTemplate: _Templates.AnnotationLabelTemplate,\n      ButtonsTemplate: _Templates.ButtonsTemplate,\n      CheckBoxTemplate: _Templates.CheckBoxTemplate,\n      CursorTemplate: _Templates.CursorTemplate,\n      DotHighlightTemplate: _Templates.DotHighlightTemplate,\n      GroupTitleTemplate: _Templates.GroupTitleTemplate,\n      HighlightTemplate: _Templates.HighlightTemplate,\n      ItemTemplate: _Templates.ItemTemplate,\n      UserTemplate: _Templates.UserTemplate,\n      LabelAnnotationTemplate: _Templates.LabelAnnotationTemplate\n    };\n    _this.tasks = namespace.TaskManagerFactory(_this.getOptions, _this.getGraphics, _this.getLayout, _this.setLayout, _this.templates);\n    return _this;\n  }\n\n  _createClass(BaseDiagram, [{\n    key: \"componentWillReceiveProps\",\n    value: function componentWillReceiveProps(nextProps) {\n      var nextConfig = nextProps.config,\n          centerOnCursor = nextProps.centerOnCursor;\n      var config = this.props.config;\n\n      if (config !== nextConfig) {\n        var highlightItem = nextConfig.highlightItem,\n            cursorItem = nextConfig.cursorItem,\n            selectedItems = nextConfig.selectedItems;\n        this.setState({\n          highlightItem: highlightItem,\n          cursorItem: cursorItem,\n          selectedItems: (selectedItems || []).slice(),\n          centerOnCursor: centerOnCursor\n        });\n      }\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      // The following code is ResizeObserver Polyfill\n      // It is added to the rendered page to track size changes of control placeholder\n      // npm install resize-observer-polyfill --save-dev\n      require('resize-observer-polyfill/dist/ResizeObserver.global');\n\n      this.observer = new ResizeObserver(this.onSizeChanged);\n      this.observer.observe(this.scrollPanelRef.current);\n      this.centerOnCursor();\n      this.fixPixelAlignment();\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      // destroy timer\n      clearTimeout(this.timer);\n      this.timer = null; // destroy observer\n\n      this.observer.disconnect();\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate() {\n      this.centerOnCursor();\n    }\n  }, {\n    key: \"centerOnCursor\",\n    value: function centerOnCursor() {\n      var centerOnCursor = this.state.centerOnCursor;\n\n      if (centerOnCursor) {\n        /* scroll to offset */\n        var centerOnCursorTask = this.tasks.getTask(\"CenterOnCursorTask\");\n        var placeholderOffset = centerOnCursorTask.getPlaceholderOffset();\n        var scrollLeft = placeholderOffset.x,\n            scrollTop = placeholderOffset.y;\n        this.scrollPanelRef.current.scrollLeft = scrollLeft;\n        this.scrollPanelRef.current.scrollTop = scrollTop;\n      }\n    }\n  }, {\n    key: \"fixPixelAlignment\",\n    value: function fixPixelAlignment() {\n      var current = this.scrollPanelRef.current;\n\n      var pixelAlignmentFix = _basicprimitives[\"default\"].common.getFixOfPixelALignment(current);\n\n      current.style.marginLeft = pixelAlignmentFix.width + \"px\";\n      current.style.marginTop = pixelAlignmentFix.height + \"px\";\n    }\n  }, {\n    key: \"onSizeChanged\",\n    value: function onSizeChanged() {\n      var _primitives$common$ge = _basicprimitives[\"default\"].common.getInnerSize(this.scrollPanelRef.current),\n          width = _primitives$common$ge.width,\n          height = _primitives$common$ge.height;\n\n      this.setState({\n        viewportSize: {\n          width: width,\n          height: height\n        },\n        centerOnCursor: true\n      });\n    }\n  }, {\n    key: \"onScroll\",\n    value: function onScroll() {\n      if (this.timer == null) {\n        this.timer = setTimeout(this.onRefreshViewport, 200);\n      }\n    }\n  }, {\n    key: \"onRefreshViewport\",\n    value: function onRefreshViewport() {\n      clearTimeout(this.timer);\n      this.timer = null;\n      var _this$scrollPanelRef$ = this.scrollPanelRef.current,\n          scrollTop = _this$scrollPanelRef$.scrollTop,\n          scrollLeft = _this$scrollPanelRef$.scrollLeft;\n      this.setState({\n        contentPosition: {\n          x: Math.floor(scrollLeft),\n          y: Math.floor(scrollTop)\n        },\n        centerOnCursor: false\n      });\n    }\n  }, {\n    key: \"onMouseMove\",\n    value: function onMouseMove(event) {\n      var placeholderOffset = _basicprimitives[\"default\"].common.getElementOffset(this.mousePanelRef.current),\n          x = event.pageX - placeholderOffset.left,\n          y = event.pageY - placeholderOffset.top,\n          createTransformTask = this.tasks.getTask(\"CreateTransformTask\"),\n          highlightItemOptionTask = this.tasks.getTask(\"HighlightItemOptionTask\");\n\n      if (highlightItemOptionTask.hasHighlightEnabled()) {\n        var itemId = createTransformTask.getTreeItemForMousePosition(x, y, highlightItemOptionTask.getGravityRadius());\n        this.setHighlightItem(event, itemId);\n      }\n    }\n  }, {\n    key: \"getEventArgs\",\n    value: function getEventArgs(oldTreeItemId, newTreeItemId, name) {\n      var result = new this.namespace.EventArgs(),\n          combinedContextsTask = this.tasks.getTask(\"CombinedContextsTask\"),\n          alignDiagramTask = this.tasks.getTask(\"AlignDiagramTask\"),\n          oldItemConfig = combinedContextsTask.getConfig(oldTreeItemId),\n          newItemConfig = combinedContextsTask.getConfig(newTreeItemId),\n          itemPosition,\n          offset,\n          panelOffset;\n\n      if (oldItemConfig && oldItemConfig.id != null) {\n        result.oldContext = oldItemConfig;\n      }\n\n      if (newItemConfig && newItemConfig.id != null) {\n        result.context = newItemConfig;\n\n        if (newItemConfig.parent !== null) {\n          result.parentItem = combinedContextsTask.getConfig(newItemConfig.parent);\n        }\n\n        panelOffset = _basicprimitives[\"default\"].common.getElementOffset(this.mousePanelRef.current);\n        offset = _basicprimitives[\"default\"].common.getElementOffset(this.scrollPanelRef.current);\n        itemPosition = alignDiagramTask.getItemPosition(newTreeItemId);\n        result.position = new _basicprimitives[\"default\"].common.Rect(itemPosition.actualPosition).translate(panelOffset.left, panelOffset.top).translate(-offset.left, -offset.top);\n      }\n\n      if (name != null) {\n        result.name = name;\n      }\n\n      return result;\n    }\n  }, {\n    key: \"setHighlightItem\",\n    value: function setHighlightItem(event, newHighlightItemId) {\n      var eventArgs,\n          cancel = false;\n      var _this$props = this.props,\n          onHighlightChanging = _this$props.onHighlightChanging,\n          onHighlightChanged = _this$props.onHighlightChanged;\n      var highlightItem = this.state.highlightItem;\n\n      if (newHighlightItemId !== highlightItem) {\n        eventArgs = this.getEventArgs(highlightItem, newHighlightItemId);\n\n        if (onHighlightChanging != null) {\n          if (!onHighlightChanging(event, eventArgs)) {\n            cancel = true;\n            this.setState({\n              highlightItem: newHighlightItemId\n            });\n          }\n        } else {\n          this.setState({\n            highlightItem: newHighlightItemId\n          });\n        }\n\n        ;\n\n        if (!cancel) {\n          if (onHighlightChanged != null) {\n            onHighlightChanged(event, eventArgs);\n          }\n        }\n      }\n    }\n  }, {\n    key: \"setCursorItem\",\n    value: function setCursorItem(event, newCursorItemId) {\n      var eventArgs,\n          cancel = false;\n      var _this$props2 = this.props,\n          onCursorChanging = _this$props2.onCursorChanging,\n          onCursorChanged = _this$props2.onCursorChanged;\n      var cursorItem = this.state.cursorItem;\n\n      if (newCursorItemId !== cursorItem) {\n        eventArgs = this.getEventArgs(cursorItem, newCursorItemId);\n\n        if (onCursorChanging != null) {\n          if (!onCursorChanging(event, eventArgs)) {\n            cancel = true;\n            this.setState({\n              cursorItem: newCursorItemId,\n              centerOnCursor: true\n            });\n          }\n        } else {\n          this.setState({\n            cursorItem: newCursorItemId,\n            centerOnCursor: true\n          });\n        }\n\n        if (!cancel) {\n          if (onCursorChanged != null) {\n            onCursorChanged(event, eventArgs);\n          }\n        }\n      }\n    }\n  }, {\n    key: \"onClick\",\n    value: function onClick(event) {\n      var placeholderOffset = _basicprimitives[\"default\"].common.getElementOffset(this.mousePanelRef.current),\n          x = event.pageX - placeholderOffset.left,\n          y = event.pageY - placeholderOffset.top,\n          createTransformTask = this.tasks.getTask(\"CreateTransformTask\"),\n          cursorItemOptionTask = this.tasks.getTask(\"CursorItemOptionTask\"),\n          highlightItemOptionTask = this.tasks.getTask(\"HighlightItemOptionTask\"),\n          newCursorItemId = createTransformTask.getTreeItemForMousePosition(x, y, highlightItemOptionTask.getGravityRadius()),\n          target;\n\n      target = event.target;\n\n      if (newCursorItemId !== null) {\n        if (target.getAttribute(\"name\") === \"checkbox\" || target.getAttribute(\"name\") === \"selectiontext\") {//ignore jslint\n        } else {\n          if (cursorItemOptionTask.hasCursorEnabled()) {\n            this.setCursorItem(event, newCursorItemId);\n            this.scrollPanelRef.current.focus();\n          }\n        }\n      }\n    }\n  }, {\n    key: \"onCheckboxChange\",\n    value: function onCheckboxChange(event) {\n      var _this$props3 = this.props,\n          onSelectionChanging = _this$props3.onSelectionChanging,\n          onSelectionChanged = _this$props3.onSelectionChanged;\n      var selectedItems = this.state.selectedItems;\n      var newSelectedItems = [];\n      var target = event.target;\n      var itemid = target.getAttribute(\"data-id\");\n      var checked = event.target.checked;\n      var cancel = false;\n\n      if (itemid != null) {\n        if (checked) {\n          newSelectedItems = [].concat(_toConsumableArray(selectedItems), [itemid]);\n        } else {\n          // eslint-disable-next-line\n          newSelectedItems = selectedItems.filter(function (id) {\n            return id != itemid;\n          }); // User type may not mach string value in data attribute\n        }\n\n        if (onSelectionChanging != null) {\n          cancel = onSelectionChanging(event, selectedItems, newSelectedItems);\n        }\n\n        if (!cancel) {\n          this.setState({\n            selectedItems: newSelectedItems\n          });\n\n          if (onSelectionChanged != null) {\n            onSelectionChanged(event, selectedItems, newSelectedItems);\n          }\n        }\n      }\n    }\n  }, {\n    key: \"onKeyDown\",\n    value: function onKeyDown(event) {\n      var highlightItemTask = this.tasks.getTask(\"HighlightItemTask\"),\n          highlightItemOptionTask = this.tasks.getTask(\"HighlightItemOptionTask\"),\n          cursorItemTask = this.tasks.getTask(\"CursorItemTask\"),\n          cursorItemOptionTask = this.tasks.getTask(\"CursorItemOptionTask\"),\n          alignDiagramTask = this.tasks.getTask('AlignDiagramTask'),\n          createTransformTask = this.tasks.getTask('CreateTransformTask'),\n          transform = createTransformTask.getTransform(),\n          navigationItem = null,\n          newNavigationItem,\n          direction = null,\n          accepted;\n\n      if (highlightItemOptionTask.hasHighlightEnabled() && cursorItemOptionTask.hasCursorEnabled()) {\n        navigationItem = highlightItemTask.getHighlightTreeItem();\n\n        if (navigationItem === null) {\n          navigationItem = cursorItemTask.getCursorTreeItem();\n        }\n      } else if (highlightItemOptionTask.hasHighlightEnabled()) {\n        navigationItem = highlightItemTask.getHighlightTreeItem();\n      } else if (cursorItemOptionTask.hasCursorEnabled()) {\n        navigationItem = cursorItemTask.getCursorTreeItem();\n      }\n\n      if (navigationItem != null) {\n        switch (event.which) {\n          case 13:\n            /*Enter*/\n            if (cursorItemOptionTask.hasCursorEnabled()) {\n              this.setCursorItem(event, navigationItem);\n              event.preventDefault();\n              this.scrollPanelRef.current.focus();\n            }\n\n            break;\n\n          case 40:\n            /*Down*/\n            direction = _basicprimitives[\"default\"].common.OrientationType.Bottom;\n            break;\n\n          case 38:\n            /*Up*/\n            direction = _basicprimitives[\"default\"].common.OrientationType.Top;\n            break;\n\n          case 37:\n            /*Left*/\n            direction = _basicprimitives[\"default\"].common.OrientationType.Left;\n            break;\n\n          case 39:\n            /*Right*/\n            direction = _basicprimitives[\"default\"].common.OrientationType.Right;\n            break;\n\n          default:\n            break;\n        }\n\n        if (direction != null) {\n          accepted = false;\n\n          while (!accepted) {\n            accepted = true;\n            direction = transform.getOrientation(direction);\n            newNavigationItem = alignDiagramTask.getNextItem(navigationItem, direction);\n\n            if (newNavigationItem != null) {\n              event.preventDefault();\n\n              if (highlightItemOptionTask.hasHighlightEnabled()) {\n                this.setHighlightItem(event, newNavigationItem);\n              } else if (cursorItemOptionTask.hasCursorEnabled()) {\n                this.setCursorItem(event, newNavigationItem);\n              }\n            }\n          }\n\n          this.scrollPanelRef.current.focus();\n        }\n      }\n    }\n  }, {\n    key: \"onItemRender\",\n    value: function onItemRender(data) {\n      var templateName = data.templateName;\n      var template = this.templatesHash[templateName];\n      return template.onItemRender(data);\n    }\n  }, {\n    key: \"onHighlightRender\",\n    value: function onHighlightRender(data) {\n      var templateName = data.templateName;\n      var template = this.templatesHash[templateName];\n      return template.onHighlightRender(data);\n    }\n  }, {\n    key: \"onCursorRender\",\n    value: function onCursorRender(data) {\n      var templateName = data.templateName;\n      var template = this.templatesHash[templateName];\n      return template.onCursorRender(data);\n    }\n  }, {\n    key: \"getOptions\",\n    value: function getOptions() {\n      var config = this.props.config;\n      var templates = config.templates || [];\n      var effectiveTemplates = templates.map(function (template) {\n        var onItemRender = template.onItemRender,\n            onHighlightRender = template.onHighlightRender,\n            onCursorRender = template.onCursorRender;\n        return _objectSpread({}, template, {\n          itemTemplate: !onItemRender ? null : \"<p>This template is not being used in React</p>\",\n          highlightTemplate: !onHighlightRender ? null : \"<p>This template is not being used in React</p>\",\n          cursorTemplate: !onCursorRender ? null : \"<p>This template is not being used in React</p>\"\n        });\n      });\n      this.templatesHash = templates.reduce(function (agg, template) {\n        var name = template.name;\n        agg[name] = template;\n        return agg;\n      }, {});\n      var _this$state = this.state,\n          highlightItem = _this$state.highlightItem,\n          cursorItem = _this$state.cursorItem,\n          selectedItems = _this$state.selectedItems;\n      return _objectSpread({}, config, {\n        templates: effectiveTemplates,\n        highlightItem: highlightItem,\n        cursorItem: cursorItem,\n        selectedItems: selectedItems,\n        onItemRender: this.onItemRender,\n        onCursorRender: this.onCursorRender,\n        onHighlightRender: this.onHighlightRender\n      });\n    }\n  }, {\n    key: \"getGraphics\",\n    value: function getGraphics() {\n      return this.graphics;\n    }\n  }, {\n    key: \"getLayout\",\n    value: function getLayout() {\n      var _this$state2 = this.state,\n          centerOnCursor = _this$state2.centerOnCursor,\n          viewportSize = _this$state2.viewportSize,\n          contentPosition = _this$state2.contentPosition;\n      return {\n        forceCenterOnCursor: centerOnCursor,\n        scrollPanelSize: viewportSize,\n        placeholderOffset: contentPosition\n      };\n    }\n  }, {\n    key: \"setLayout\",\n    value: function setLayout(layoutOptions) {\n      var autoSize = layoutOptions.autoSize,\n          scale = layoutOptions.scale,\n          contentSize = layoutOptions.contentSize,\n          scrollPanelSize = layoutOptions.scrollPanelSize,\n          autoSizeMinimum = layoutOptions.autoSizeMinimum,\n          autoSizeMaximum = layoutOptions.autoSizeMaximum;\n      /* set size of panel with content */\n\n      var mousePanelSize = new _basicprimitives[\"default\"].common.Size(contentSize);\n      mousePanelSize.scale(1 * scale);\n      var scrollPanelAutoSize = new _basicprimitives[\"default\"].common.Size(scrollPanelSize);\n\n      if (autoSize) {\n        /* resize element to fit placeholder if control in autosize mode */\n        scrollPanelAutoSize = new _basicprimitives[\"default\"].common.Size(mousePanelSize.width + 25, mousePanelSize.height + 25);\n        scrollPanelAutoSize.cropBySize(autoSizeMaximum);\n        scrollPanelAutoSize.addSize(autoSizeMinimum); //ignore jslint\n      }\n\n      this.layoutOptions = {\n        autoSize: autoSize,\n        scrollPanelSize: scrollPanelAutoSize,\n        mousePanelSize: mousePanelSize,\n        scale: scale\n      };\n      return scrollPanelAutoSize;\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var graphics = this.graphics;\n      this.tasks.process('OptionsTask', null, false);\n      var _this$graphics$placeh = this.graphics.placeholders,\n          placeholder = _this$graphics$placeh.placeholder,\n          calloutplaceholder = _this$graphics$placeh.calloutplaceholder;\n      var placeholderRectCSS = placeholder.rect.getCSS();\n      var _this$layoutOptions = this.layoutOptions,\n          autoSize = _this$layoutOptions.autoSize,\n          scale = _this$layoutOptions.scale,\n          scrollPanelSize = _this$layoutOptions.scrollPanelSize,\n          mousePanelSize = _this$layoutOptions.mousePanelSize;\n      /* set CSS scale of content */\n\n      var scaletext = \"scale(\" + scale + \",\" + scale + \")\";\n      return _react[\"default\"].createElement(_react[\"default\"].Fragment, null, _react[\"default\"].createElement(\"div\", {\n        ref: this.scrollPanelRef,\n        onScroll: this.onScroll,\n        onKeyDown: this.onKeyDown,\n        style: _objectSpread({\n          position: \"relative\",\n          overflow: \"auto\",\n          WebkitOverflowScrolling: \"touch\",\n          width: \"100%\",\n          height: \"100%\",\n          padding: \"0px\",\n          marginBottom: \"0px\",\n          marginRight: \"0px\"\n        }, autoSize ? scrollPanelSize.getCSS() : {}),\n        tabIndex: \"0\"\n      }, _react[\"default\"].createElement(\"div\", {\n        ref: this.mousePanelRef,\n        onMouseMove: this.onMouseMove,\n        onClick: this.onClick,\n        onChange: this.onCheckboxChange,\n        style: _objectSpread({\n          position: \"absolute\",\n          overflow: \"hidden\"\n        }, mousePanelSize.getCSS())\n      }, _react[\"default\"].createElement(\"div\", {\n        ref: this.placeholderRef,\n        style: _objectSpread({}, placeholderRectCSS, {\n          position: \"absolute\",\n          overflow: \"hidden\",\n          \"transformOrigin\": \"0 0\",\n          \"transform\": scaletext,\n          \"msTransform\": scaletext,\n\n          /* IE 9 */\n          \"WebkitTransform\": scaletext,\n\n          /* Safari and Chrome */\n          \"OTransform\": scaletext,\n\n          /* Opera */\n          \"MozTransform\": scaletext\n          /* Firefox */\n\n        })\n      }, graphics.map(this, \"placeholder\", function (layerKey, elements) {\n        return _react[\"default\"].createElement(\"div\", {\n          key: layerKey,\n          style: {\n            position: \"absolute\",\n            overflow: \"visible\",\n            left: \"0px\",\n            top: \"0px\"\n          }\n        }, elements);\n      }), calloutplaceholder && _react[\"default\"].createElement(\"div\", {\n        key: \"Callout\",\n        style: {\n          position: \"absolute\",\n          overflow: \"visible\",\n          left: calloutplaceholder.rect.x + \"px\",\n          top: calloutplaceholder.rect.y + \"px\"\n        }\n      }, graphics.map(this, \"calloutplaceholder\", function (layerKey, elements) {\n        return _react[\"default\"].createElement(\"div\", {\n          key: layerKey,\n          style: {\n            position: \"absolute\",\n            overflow: \"visible\"\n          }\n        }, elements);\n      }))))));\n    }\n  }]);\n\n  return BaseDiagram;\n}(_react.Component);\n\n_defineProperty(BaseDiagram, \"propTypes\", {\n  centerOnCursor: _propTypes[\"default\"].bool,\n  // eslint-disable-line react/no-unused-prop-types\n  onHighlightChanging: _propTypes[\"default\"].func,\n  // eslint-disable-line react/no-unused-prop-types\n  onHighlightChanged: _propTypes[\"default\"].func,\n  // eslint-disable-line react/no-unused-prop-types\n  onCursorChanging: _propTypes[\"default\"].func,\n  // eslint-disable-line react/no-unused-prop-types\n  onCursorChanged: _propTypes[\"default\"].func,\n  // eslint-disable-line react/no-unused-prop-types\n  onSelectionChanging: _propTypes[\"default\"].func,\n  // eslint-disable-line react/no-unused-prop-types\n  onSelectionChanged: _propTypes[\"default\"].func // eslint-disable-line react/no-unused-prop-types\n\n});\n\n_defineProperty(BaseDiagram, \"defaultProps\", {\n  centerOnCursor: true,\n  onHighlightChanging: null,\n  onHighlightChanged: null,\n  onCursorChanging: null,\n  onCursorChanged: null,\n  onSelectionChanging: null,\n  onSelectionChanged: null\n});\n\nvar _default = BaseDiagram;\nexports[\"default\"] = _default;","map":{"version":3,"sources":["C:/Users/demon/PycharmProjects/datamozg/node_modules/basicprimitivesreact/dist/BaseDiagram.js"],"names":["Object","defineProperty","exports","value","_react","_interopRequireWildcard","require","_propTypes","_interopRequireDefault","_basicprimitives","_Graphics","_Templates","obj","__esModule","_getRequireWildcardCache","WeakMap","cache","_typeof","has","get","newObj","hasPropertyDescriptor","getOwnPropertyDescriptor","key","prototype","hasOwnProperty","call","desc","set","Symbol","iterator","constructor","ownKeys","object","enumerableOnly","keys","getOwnPropertySymbols","symbols","filter","sym","enumerable","push","apply","_objectSpread","target","i","arguments","length","source","forEach","_defineProperty","getOwnPropertyDescriptors","defineProperties","_toConsumableArray","arr","_arrayWithoutHoles","_iterableToArray","_nonIterableSpread","TypeError","iter","toString","Array","from","isArray","arr2","_classCallCheck","instance","Constructor","_defineProperties","props","descriptor","configurable","writable","_createClass","protoProps","staticProps","_possibleConstructorReturn","self","_assertThisInitialized","_getPrototypeOf","o","setPrototypeOf","getPrototypeOf","__proto__","ReferenceError","_inherits","subClass","superClass","create","_setPrototypeOf","p","BaseDiagram","_Component","namespace","_this","config","centerOnCursor","highlightItem","cursorItem","selectedItems","state","viewportSize","width","height","contentPosition","x","y","slice","onRefreshViewport","bind","onSizeChanged","onScroll","onMouseMove","onClick","onCheckboxChange","onKeyDown","getOptions","getGraphics","getLayout","setLayout","getEventArgs","onItemRender","onHighlightRender","onCursorRender","scrollPanelRef","createRef","mousePanelRef","placeholderRef","calloutPlaceholderRef","layoutOptions","templatesHash","graphics","templates","AnnotationLabelTemplate","ButtonsTemplate","CheckBoxTemplate","CursorTemplate","DotHighlightTemplate","GroupTitleTemplate","HighlightTemplate","ItemTemplate","UserTemplate","LabelAnnotationTemplate","tasks","TaskManagerFactory","componentWillReceiveProps","nextProps","nextConfig","setState","componentDidMount","observer","ResizeObserver","observe","current","fixPixelAlignment","componentWillUnmount","clearTimeout","timer","disconnect","componentDidUpdate","centerOnCursorTask","getTask","placeholderOffset","getPlaceholderOffset","scrollLeft","scrollTop","pixelAlignmentFix","common","getFixOfPixelALignment","style","marginLeft","marginTop","_primitives$common$ge","getInnerSize","setTimeout","_this$scrollPanelRef$","Math","floor","event","getElementOffset","pageX","left","pageY","top","createTransformTask","highlightItemOptionTask","hasHighlightEnabled","itemId","getTreeItemForMousePosition","getGravityRadius","setHighlightItem","oldTreeItemId","newTreeItemId","name","result","EventArgs","combinedContextsTask","alignDiagramTask","oldItemConfig","getConfig","newItemConfig","itemPosition","offset","panelOffset","id","oldContext","context","parent","parentItem","getItemPosition","position","Rect","actualPosition","translate","newHighlightItemId","eventArgs","cancel","_this$props","onHighlightChanging","onHighlightChanged","setCursorItem","newCursorItemId","_this$props2","onCursorChanging","onCursorChanged","cursorItemOptionTask","getAttribute","hasCursorEnabled","focus","_this$props3","onSelectionChanging","onSelectionChanged","newSelectedItems","itemid","checked","concat","highlightItemTask","cursorItemTask","transform","getTransform","navigationItem","newNavigationItem","direction","accepted","getHighlightTreeItem","getCursorTreeItem","which","preventDefault","OrientationType","Bottom","Top","Left","Right","getOrientation","getNextItem","data","templateName","template","effectiveTemplates","map","itemTemplate","highlightTemplate","cursorTemplate","reduce","agg","_this$state","_this$state2","forceCenterOnCursor","scrollPanelSize","autoSize","scale","contentSize","autoSizeMinimum","autoSizeMaximum","mousePanelSize","Size","scrollPanelAutoSize","cropBySize","addSize","render","process","_this$graphics$placeh","placeholders","placeholder","calloutplaceholder","placeholderRectCSS","rect","getCSS","_this$layoutOptions","scaletext","createElement","Fragment","ref","overflow","WebkitOverflowScrolling","padding","marginBottom","marginRight","tabIndex","onChange","layerKey","elements","Component","bool","func","_default"],"mappings":"AAAA;;AAEAA,MAAM,CAACC,cAAP,CAAsBC,OAAtB,EAA+B,YAA/B,EAA6C;AAC3CC,EAAAA,KAAK,EAAE;AADoC,CAA7C;AAGAD,OAAO,CAAC,SAAD,CAAP,GAAqB,KAAK,CAA1B;;AAEA,IAAIE,MAAM,GAAGC,uBAAuB,CAACC,OAAO,CAAC,OAAD,CAAR,CAApC;;AAEA,IAAIC,UAAU,GAAGC,sBAAsB,CAACF,OAAO,CAAC,YAAD,CAAR,CAAvC;;AAEA,IAAIG,gBAAgB,GAAGD,sBAAsB,CAACF,OAAO,CAAC,iBAAD,CAAR,CAA7C;;AAEA,IAAII,SAAS,GAAGF,sBAAsB,CAACF,OAAO,CAAC,YAAD,CAAR,CAAtC;;AAEA,IAAIK,UAAU,GAAGL,OAAO,CAAC,aAAD,CAAxB;;AAEA,SAASE,sBAAT,CAAgCI,GAAhC,EAAqC;AAAE,SAAOA,GAAG,IAAIA,GAAG,CAACC,UAAX,GAAwBD,GAAxB,GAA8B;AAAE,eAAWA;AAAb,GAArC;AAA0D;;AAEjG,SAASE,wBAAT,GAAoC;AAAE,MAAI,OAAOC,OAAP,KAAmB,UAAvB,EAAmC,OAAO,IAAP;AAAa,MAAIC,KAAK,GAAG,IAAID,OAAJ,EAAZ;;AAA2BD,EAAAA,wBAAwB,GAAG,SAASA,wBAAT,GAAoC;AAAE,WAAOE,KAAP;AAAe,GAAhF;;AAAkF,SAAOA,KAAP;AAAe;;AAElN,SAASX,uBAAT,CAAiCO,GAAjC,EAAsC;AAAE,MAAIA,GAAG,IAAIA,GAAG,CAACC,UAAf,EAA2B;AAAE,WAAOD,GAAP;AAAa;;AAAC,MAAIA,GAAG,KAAK,IAAR,IAAgBK,OAAO,CAACL,GAAD,CAAP,KAAiB,QAAjB,IAA6B,OAAOA,GAAP,KAAe,UAAhE,EAA4E;AAAE,WAAO;AAAE,iBAAWA;AAAb,KAAP;AAA4B;;AAAC,MAAII,KAAK,GAAGF,wBAAwB,EAApC;;AAAwC,MAAIE,KAAK,IAAIA,KAAK,CAACE,GAAN,CAAUN,GAAV,CAAb,EAA6B;AAAE,WAAOI,KAAK,CAACG,GAAN,CAAUP,GAAV,CAAP;AAAwB;;AAAC,MAAIQ,MAAM,GAAG,EAAb;AAAiB,MAAIC,qBAAqB,GAAGrB,MAAM,CAACC,cAAP,IAAyBD,MAAM,CAACsB,wBAA5D;;AAAsF,OAAK,IAAIC,GAAT,IAAgBX,GAAhB,EAAqB;AAAE,QAAIZ,MAAM,CAACwB,SAAP,CAAiBC,cAAjB,CAAgCC,IAAhC,CAAqCd,GAArC,EAA0CW,GAA1C,CAAJ,EAAoD;AAAE,UAAII,IAAI,GAAGN,qBAAqB,GAAGrB,MAAM,CAACsB,wBAAP,CAAgCV,GAAhC,EAAqCW,GAArC,CAAH,GAA+C,IAA/E;;AAAqF,UAAII,IAAI,KAAKA,IAAI,CAACR,GAAL,IAAYQ,IAAI,CAACC,GAAtB,CAAR,EAAoC;AAAE5B,QAAAA,MAAM,CAACC,cAAP,CAAsBmB,MAAtB,EAA8BG,GAA9B,EAAmCI,IAAnC;AAA2C,OAAjF,MAAuF;AAAEP,QAAAA,MAAM,CAACG,GAAD,CAAN,GAAcX,GAAG,CAACW,GAAD,CAAjB;AAAyB;AAAE;AAAE;;AAACH,EAAAA,MAAM,CAAC,SAAD,CAAN,GAAoBR,GAApB;;AAAyB,MAAII,KAAJ,EAAW;AAAEA,IAAAA,KAAK,CAACY,GAAN,CAAUhB,GAAV,EAAeQ,MAAf;AAAyB;;AAAC,SAAOA,MAAP;AAAgB;;AAE9uB,SAASH,OAAT,CAAiBL,GAAjB,EAAsB;AAAE,MAAI,OAAOiB,MAAP,KAAkB,UAAlB,IAAgC,OAAOA,MAAM,CAACC,QAAd,KAA2B,QAA/D,EAAyE;AAAEb,IAAAA,OAAO,GAAG,SAASA,OAAT,CAAiBL,GAAjB,EAAsB;AAAE,aAAO,OAAOA,GAAd;AAAoB,KAAtD;AAAyD,GAApI,MAA0I;AAAEK,IAAAA,OAAO,GAAG,SAASA,OAAT,CAAiBL,GAAjB,EAAsB;AAAE,aAAOA,GAAG,IAAI,OAAOiB,MAAP,KAAkB,UAAzB,IAAuCjB,GAAG,CAACmB,WAAJ,KAAoBF,MAA3D,IAAqEjB,GAAG,KAAKiB,MAAM,CAACL,SAApF,GAAgG,QAAhG,GAA2G,OAAOZ,GAAzH;AAA+H,KAAjK;AAAoK;;AAAC,SAAOK,OAAO,CAACL,GAAD,CAAd;AAAsB;;AAE/V,SAASoB,OAAT,CAAiBC,MAAjB,EAAyBC,cAAzB,EAAyC;AAAE,MAAIC,IAAI,GAAGnC,MAAM,CAACmC,IAAP,CAAYF,MAAZ,CAAX;;AAAgC,MAAIjC,MAAM,CAACoC,qBAAX,EAAkC;AAAE,QAAIC,OAAO,GAAGrC,MAAM,CAACoC,qBAAP,CAA6BH,MAA7B,CAAd;AAAoD,QAAIC,cAAJ,EAAoBG,OAAO,GAAGA,OAAO,CAACC,MAAR,CAAe,UAAUC,GAAV,EAAe;AAAE,aAAOvC,MAAM,CAACsB,wBAAP,CAAgCW,MAAhC,EAAwCM,GAAxC,EAA6CC,UAApD;AAAiE,KAAjG,CAAV;AAA8GL,IAAAA,IAAI,CAACM,IAAL,CAAUC,KAAV,CAAgBP,IAAhB,EAAsBE,OAAtB;AAAiC;;AAAC,SAAOF,IAAP;AAAc;;AAErV,SAASQ,aAAT,CAAuBC,MAAvB,EAA+B;AAAE,OAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGC,SAAS,CAACC,MAA9B,EAAsCF,CAAC,EAAvC,EAA2C;AAAE,QAAIG,MAAM,GAAGF,SAAS,CAACD,CAAD,CAAT,IAAgB,IAAhB,GAAuBC,SAAS,CAACD,CAAD,CAAhC,GAAsC,EAAnD;;AAAuD,QAAIA,CAAC,GAAG,CAAR,EAAW;AAAEb,MAAAA,OAAO,CAAChC,MAAM,CAACgD,MAAD,CAAP,EAAiB,IAAjB,CAAP,CAA8BC,OAA9B,CAAsC,UAAU1B,GAAV,EAAe;AAAE2B,QAAAA,eAAe,CAACN,MAAD,EAASrB,GAAT,EAAcyB,MAAM,CAACzB,GAAD,CAApB,CAAf;AAA4C,OAAnG;AAAuG,KAApH,MAA0H,IAAIvB,MAAM,CAACmD,yBAAX,EAAsC;AAAEnD,MAAAA,MAAM,CAACoD,gBAAP,CAAwBR,MAAxB,EAAgC5C,MAAM,CAACmD,yBAAP,CAAiCH,MAAjC,CAAhC;AAA4E,KAApH,MAA0H;AAAEhB,MAAAA,OAAO,CAAChC,MAAM,CAACgD,MAAD,CAAP,CAAP,CAAwBC,OAAxB,CAAgC,UAAU1B,GAAV,EAAe;AAAEvB,QAAAA,MAAM,CAACC,cAAP,CAAsB2C,MAAtB,EAA8BrB,GAA9B,EAAmCvB,MAAM,CAACsB,wBAAP,CAAgC0B,MAAhC,EAAwCzB,GAAxC,CAAnC;AAAmF,OAApI;AAAwI;AAAE;;AAAC,SAAOqB,MAAP;AAAgB;;AAEthB,SAASS,kBAAT,CAA4BC,GAA5B,EAAiC;AAAE,SAAOC,kBAAkB,CAACD,GAAD,CAAlB,IAA2BE,gBAAgB,CAACF,GAAD,CAA3C,IAAoDG,kBAAkB,EAA7E;AAAkF;;AAErH,SAASA,kBAAT,GAA8B;AAAE,QAAM,IAAIC,SAAJ,CAAc,iDAAd,CAAN;AAAyE;;AAEzG,SAASF,gBAAT,CAA0BG,IAA1B,EAAgC;AAAE,MAAI9B,MAAM,CAACC,QAAP,IAAmB9B,MAAM,CAAC2D,IAAD,CAAzB,IAAmC3D,MAAM,CAACwB,SAAP,CAAiBoC,QAAjB,CAA0BlC,IAA1B,CAA+BiC,IAA/B,MAAyC,oBAAhF,EAAsG,OAAOE,KAAK,CAACC,IAAN,CAAWH,IAAX,CAAP;AAA0B;;AAElK,SAASJ,kBAAT,CAA4BD,GAA5B,EAAiC;AAAE,MAAIO,KAAK,CAACE,OAAN,CAAcT,GAAd,CAAJ,EAAwB;AAAE,SAAK,IAAIT,CAAC,GAAG,CAAR,EAAWmB,IAAI,GAAG,IAAIH,KAAJ,CAAUP,GAAG,CAACP,MAAd,CAAvB,EAA8CF,CAAC,GAAGS,GAAG,CAACP,MAAtD,EAA8DF,CAAC,EAA/D,EAAmE;AAAEmB,MAAAA,IAAI,CAACnB,CAAD,CAAJ,GAAUS,GAAG,CAACT,CAAD,CAAb;AAAmB;;AAAC,WAAOmB,IAAP;AAAc;AAAE;;AAEtK,SAASC,eAAT,CAAyBC,QAAzB,EAAmCC,WAAnC,EAAgD;AAAE,MAAI,EAAED,QAAQ,YAAYC,WAAtB,CAAJ,EAAwC;AAAE,UAAM,IAAIT,SAAJ,CAAc,mCAAd,CAAN;AAA2D;AAAE;;AAEzJ,SAASU,iBAAT,CAA2BxB,MAA3B,EAAmCyB,KAAnC,EAA0C;AAAE,OAAK,IAAIxB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGwB,KAAK,CAACtB,MAA1B,EAAkCF,CAAC,EAAnC,EAAuC;AAAE,QAAIyB,UAAU,GAAGD,KAAK,CAACxB,CAAD,CAAtB;AAA2ByB,IAAAA,UAAU,CAAC9B,UAAX,GAAwB8B,UAAU,CAAC9B,UAAX,IAAyB,KAAjD;AAAwD8B,IAAAA,UAAU,CAACC,YAAX,GAA0B,IAA1B;AAAgC,QAAI,WAAWD,UAAf,EAA2BA,UAAU,CAACE,QAAX,GAAsB,IAAtB;AAA4BxE,IAAAA,MAAM,CAACC,cAAP,CAAsB2C,MAAtB,EAA8B0B,UAAU,CAAC/C,GAAzC,EAA8C+C,UAA9C;AAA4D;AAAE;;AAE7T,SAASG,YAAT,CAAsBN,WAAtB,EAAmCO,UAAnC,EAA+CC,WAA/C,EAA4D;AAAE,MAAID,UAAJ,EAAgBN,iBAAiB,CAACD,WAAW,CAAC3C,SAAb,EAAwBkD,UAAxB,CAAjB;AAAsD,MAAIC,WAAJ,EAAiBP,iBAAiB,CAACD,WAAD,EAAcQ,WAAd,CAAjB;AAA6C,SAAOR,WAAP;AAAqB;;AAEvN,SAASS,0BAAT,CAAoCC,IAApC,EAA0CnD,IAA1C,EAAgD;AAAE,MAAIA,IAAI,KAAKT,OAAO,CAACS,IAAD,CAAP,KAAkB,QAAlB,IAA8B,OAAOA,IAAP,KAAgB,UAAnD,CAAR,EAAwE;AAAE,WAAOA,IAAP;AAAc;;AAAC,SAAOoD,sBAAsB,CAACD,IAAD,CAA7B;AAAsC;;AAEjL,SAASE,eAAT,CAAyBC,CAAzB,EAA4B;AAAED,EAAAA,eAAe,GAAG/E,MAAM,CAACiF,cAAP,GAAwBjF,MAAM,CAACkF,cAA/B,GAAgD,SAASH,eAAT,CAAyBC,CAAzB,EAA4B;AAAE,WAAOA,CAAC,CAACG,SAAF,IAAenF,MAAM,CAACkF,cAAP,CAAsBF,CAAtB,CAAtB;AAAiD,GAAjJ;AAAmJ,SAAOD,eAAe,CAACC,CAAD,CAAtB;AAA4B;;AAE7M,SAASF,sBAAT,CAAgCD,IAAhC,EAAsC;AAAE,MAAIA,IAAI,KAAK,KAAK,CAAlB,EAAqB;AAAE,UAAM,IAAIO,cAAJ,CAAmB,2DAAnB,CAAN;AAAwF;;AAAC,SAAOP,IAAP;AAAc;;AAEtK,SAASQ,SAAT,CAAmBC,QAAnB,EAA6BC,UAA7B,EAAyC;AAAE,MAAI,OAAOA,UAAP,KAAsB,UAAtB,IAAoCA,UAAU,KAAK,IAAvD,EAA6D;AAAE,UAAM,IAAI7B,SAAJ,CAAc,oDAAd,CAAN;AAA4E;;AAAC4B,EAAAA,QAAQ,CAAC9D,SAAT,GAAqBxB,MAAM,CAACwF,MAAP,CAAcD,UAAU,IAAIA,UAAU,CAAC/D,SAAvC,EAAkD;AAAEO,IAAAA,WAAW,EAAE;AAAE5B,MAAAA,KAAK,EAAEmF,QAAT;AAAmBd,MAAAA,QAAQ,EAAE,IAA7B;AAAmCD,MAAAA,YAAY,EAAE;AAAjD;AAAf,GAAlD,CAArB;AAAkJ,MAAIgB,UAAJ,EAAgBE,eAAe,CAACH,QAAD,EAAWC,UAAX,CAAf;AAAwC;;AAEjY,SAASE,eAAT,CAAyBT,CAAzB,EAA4BU,CAA5B,EAA+B;AAAED,EAAAA,eAAe,GAAGzF,MAAM,CAACiF,cAAP,IAAyB,SAASQ,eAAT,CAAyBT,CAAzB,EAA4BU,CAA5B,EAA+B;AAAEV,IAAAA,CAAC,CAACG,SAAF,GAAcO,CAAd;AAAiB,WAAOV,CAAP;AAAW,GAAxG;;AAA0G,SAAOS,eAAe,CAACT,CAAD,EAAIU,CAAJ,CAAtB;AAA+B;;AAE1K,SAASxC,eAAT,CAAyBtC,GAAzB,EAA8BW,GAA9B,EAAmCpB,KAAnC,EAA0C;AAAE,MAAIoB,GAAG,IAAIX,GAAX,EAAgB;AAAEZ,IAAAA,MAAM,CAACC,cAAP,CAAsBW,GAAtB,EAA2BW,GAA3B,EAAgC;AAAEpB,MAAAA,KAAK,EAAEA,KAAT;AAAgBqC,MAAAA,UAAU,EAAE,IAA5B;AAAkC+B,MAAAA,YAAY,EAAE,IAAhD;AAAsDC,MAAAA,QAAQ,EAAE;AAAhE,KAAhC;AAA0G,GAA5H,MAAkI;AAAE5D,IAAAA,GAAG,CAACW,GAAD,CAAH,GAAWpB,KAAX;AAAmB;;AAAC,SAAOS,GAAP;AAAa;;AAEjN,IAAI+E,WAAW;AACf;AACA,UAAUC,UAAV,EAAsB;AACpBP,EAAAA,SAAS,CAACM,WAAD,EAAcC,UAAd,CAAT;;AAEA,WAASD,WAAT,CAAqBtB,KAArB,EAA4BwB,SAA5B,EAAuC;AACrC,QAAIC,KAAJ;;AAEA7B,IAAAA,eAAe,CAAC,IAAD,EAAO0B,WAAP,CAAf;;AAEAG,IAAAA,KAAK,GAAGlB,0BAA0B,CAAC,IAAD,EAAOG,eAAe,CAACY,WAAD,CAAf,CAA6BjE,IAA7B,CAAkC,IAAlC,EAAwC2C,KAAxC,CAAP,CAAlC;AACAyB,IAAAA,KAAK,CAACD,SAAN,GAAkBA,SAAlB;AACA,QAAIE,MAAM,GAAG1B,KAAK,CAAC0B,MAAnB;AAAA,QACIC,cAAc,GAAG3B,KAAK,CAAC2B,cAD3B;AAEA,QAAIC,aAAa,GAAGF,MAAM,CAACE,aAA3B;AAAA,QACIC,UAAU,GAAGH,MAAM,CAACG,UADxB;AAAA,QAEIC,aAAa,GAAGJ,MAAM,CAACI,aAF3B;AAGAL,IAAAA,KAAK,CAACM,KAAN,GAAc;AACZC,MAAAA,YAAY,EAAE;AACZC,QAAAA,KAAK,EAAE,CADK;AAEZC,QAAAA,MAAM,EAAE;AAFI,OADF;AAKZC,MAAAA,eAAe,EAAE;AACfC,QAAAA,CAAC,EAAE,CADY;AAEfC,QAAAA,CAAC,EAAE;AAFY,OALL;AASZV,MAAAA,cAAc,EAAEA,cATJ;AAUZC,MAAAA,aAAa,EAAEA,aAVH;AAWZC,MAAAA,UAAU,EAAEA,UAXA;AAYZC,MAAAA,aAAa,EAAE,CAACA,aAAa,IAAI,EAAlB,EAAsBQ,KAAtB;AAZH,KAAd;AAcA,QAAIN,YAAY,GAAGP,KAAK,CAACM,KAAN,CAAYC,YAA/B;AACAP,IAAAA,KAAK,CAACc,iBAAN,GAA0Bd,KAAK,CAACc,iBAAN,CAAwBC,IAAxB,CAA6B/B,sBAAsB,CAACgB,KAAD,CAAnD,CAA1B;AACAA,IAAAA,KAAK,CAACgB,aAAN,GAAsBhB,KAAK,CAACgB,aAAN,CAAoBD,IAApB,CAAyB/B,sBAAsB,CAACgB,KAAD,CAA/C,CAAtB;AACAA,IAAAA,KAAK,CAACiB,QAAN,GAAiBjB,KAAK,CAACiB,QAAN,CAAeF,IAAf,CAAoB/B,sBAAsB,CAACgB,KAAD,CAA1C,CAAjB;AACAA,IAAAA,KAAK,CAACkB,WAAN,GAAoBlB,KAAK,CAACkB,WAAN,CAAkBH,IAAlB,CAAuB/B,sBAAsB,CAACgB,KAAD,CAA7C,CAApB;AACAA,IAAAA,KAAK,CAACmB,OAAN,GAAgBnB,KAAK,CAACmB,OAAN,CAAcJ,IAAd,CAAmB/B,sBAAsB,CAACgB,KAAD,CAAzC,CAAhB;AACAA,IAAAA,KAAK,CAACoB,gBAAN,GAAyBpB,KAAK,CAACoB,gBAAN,CAAuBL,IAAvB,CAA4B/B,sBAAsB,CAACgB,KAAD,CAAlD,CAAzB;AACAA,IAAAA,KAAK,CAACqB,SAAN,GAAkBrB,KAAK,CAACqB,SAAN,CAAgBN,IAAhB,CAAqB/B,sBAAsB,CAACgB,KAAD,CAA3C,CAAlB;AACAA,IAAAA,KAAK,CAACsB,UAAN,GAAmBtB,KAAK,CAACsB,UAAN,CAAiBP,IAAjB,CAAsB/B,sBAAsB,CAACgB,KAAD,CAA5C,CAAnB;AACAA,IAAAA,KAAK,CAACuB,WAAN,GAAoBvB,KAAK,CAACuB,WAAN,CAAkBR,IAAlB,CAAuB/B,sBAAsB,CAACgB,KAAD,CAA7C,CAApB;AACAA,IAAAA,KAAK,CAACwB,SAAN,GAAkBxB,KAAK,CAACwB,SAAN,CAAgBT,IAAhB,CAAqB/B,sBAAsB,CAACgB,KAAD,CAA3C,CAAlB;AACAA,IAAAA,KAAK,CAACyB,SAAN,GAAkBzB,KAAK,CAACyB,SAAN,CAAgBV,IAAhB,CAAqB/B,sBAAsB,CAACgB,KAAD,CAA3C,CAAlB;AACAA,IAAAA,KAAK,CAAC0B,YAAN,GAAqB1B,KAAK,CAAC0B,YAAN,CAAmBX,IAAnB,CAAwB/B,sBAAsB,CAACgB,KAAD,CAA9C,CAArB;AACAA,IAAAA,KAAK,CAACE,cAAN,GAAuBF,KAAK,CAACE,cAAN,CAAqBa,IAArB,CAA0B/B,sBAAsB,CAACgB,KAAD,CAAhD,CAAvB;AACAA,IAAAA,KAAK,CAAC2B,YAAN,GAAqB3B,KAAK,CAAC2B,YAAN,CAAmBZ,IAAnB,CAAwB/B,sBAAsB,CAACgB,KAAD,CAA9C,CAArB;AACAA,IAAAA,KAAK,CAAC4B,iBAAN,GAA0B5B,KAAK,CAAC4B,iBAAN,CAAwBb,IAAxB,CAA6B/B,sBAAsB,CAACgB,KAAD,CAAnD,CAA1B;AACAA,IAAAA,KAAK,CAAC6B,cAAN,GAAuB7B,KAAK,CAAC6B,cAAN,CAAqBd,IAArB,CAA0B/B,sBAAsB,CAACgB,KAAD,CAAhD,CAAvB;AACAA,IAAAA,KAAK,CAAC8B,cAAN,GAAuBxH,MAAM,CAAC,SAAD,CAAN,CAAkByH,SAAlB,EAAvB;AACA/B,IAAAA,KAAK,CAACgC,aAAN,GAAsB1H,MAAM,CAAC,SAAD,CAAN,CAAkByH,SAAlB,EAAtB;AACA/B,IAAAA,KAAK,CAACiC,cAAN,GAAuB3H,MAAM,CAAC,SAAD,CAAN,CAAkByH,SAAlB,EAAvB;AACA/B,IAAAA,KAAK,CAACkC,qBAAN,GAA8B5H,MAAM,CAAC,SAAD,CAAN,CAAkByH,SAAlB,EAA9B;AACA/B,IAAAA,KAAK,CAACmC,aAAN,GAAsB,EAAtB;AACAnC,IAAAA,KAAK,CAACoC,aAAN,GAAsB,EAAtB;AACApC,IAAAA,KAAK,CAACqC,QAAN,GAAiB,IAAIzH,SAAS,CAAC,SAAD,CAAb,CAAyB2F,YAAzB,CAAjB;AACAP,IAAAA,KAAK,CAACsC,SAAN,GAAkB;AAChBC,MAAAA,uBAAuB,EAAE1H,UAAU,CAAC0H,uBADpB;AAEhBC,MAAAA,eAAe,EAAE3H,UAAU,CAAC2H,eAFZ;AAGhBC,MAAAA,gBAAgB,EAAE5H,UAAU,CAAC4H,gBAHb;AAIhBC,MAAAA,cAAc,EAAE7H,UAAU,CAAC6H,cAJX;AAKhBC,MAAAA,oBAAoB,EAAE9H,UAAU,CAAC8H,oBALjB;AAMhBC,MAAAA,kBAAkB,EAAE/H,UAAU,CAAC+H,kBANf;AAOhBC,MAAAA,iBAAiB,EAAEhI,UAAU,CAACgI,iBAPd;AAQhBC,MAAAA,YAAY,EAAEjI,UAAU,CAACiI,YART;AAShBC,MAAAA,YAAY,EAAElI,UAAU,CAACkI,YATT;AAUhBC,MAAAA,uBAAuB,EAAEnI,UAAU,CAACmI;AAVpB,KAAlB;AAYAhD,IAAAA,KAAK,CAACiD,KAAN,GAAclD,SAAS,CAACmD,kBAAV,CAA6BlD,KAAK,CAACsB,UAAnC,EAA+CtB,KAAK,CAACuB,WAArD,EAAkEvB,KAAK,CAACwB,SAAxE,EAAmFxB,KAAK,CAACyB,SAAzF,EAAoGzB,KAAK,CAACsC,SAA1G,CAAd;AACA,WAAOtC,KAAP;AACD;;AAEDrB,EAAAA,YAAY,CAACkB,WAAD,EAAc,CAAC;AACzBpE,IAAAA,GAAG,EAAE,2BADoB;AAEzBpB,IAAAA,KAAK,EAAE,SAAS8I,yBAAT,CAAmCC,SAAnC,EAA8C;AACnD,UAAIC,UAAU,GAAGD,SAAS,CAACnD,MAA3B;AAAA,UACIC,cAAc,GAAGkD,SAAS,CAAClD,cAD/B;AAEA,UAAID,MAAM,GAAG,KAAK1B,KAAL,CAAW0B,MAAxB;;AAEA,UAAIA,MAAM,KAAKoD,UAAf,EAA2B;AACzB,YAAIlD,aAAa,GAAGkD,UAAU,CAAClD,aAA/B;AAAA,YACIC,UAAU,GAAGiD,UAAU,CAACjD,UAD5B;AAAA,YAEIC,aAAa,GAAGgD,UAAU,CAAChD,aAF/B;AAGA,aAAKiD,QAAL,CAAc;AACZnD,UAAAA,aAAa,EAAEA,aADH;AAEZC,UAAAA,UAAU,EAAEA,UAFA;AAGZC,UAAAA,aAAa,EAAE,CAACA,aAAa,IAAI,EAAlB,EAAsBQ,KAAtB,EAHH;AAIZX,UAAAA,cAAc,EAAEA;AAJJ,SAAd;AAMD;AACF;AAlBwB,GAAD,EAmBvB;AACDzE,IAAAA,GAAG,EAAE,mBADJ;AAEDpB,IAAAA,KAAK,EAAE,SAASkJ,iBAAT,GAA6B;AAClC;AACA;AACA;AACA/I,MAAAA,OAAO,CAAC,qDAAD,CAAP;;AAEA,WAAKgJ,QAAL,GAAgB,IAAIC,cAAJ,CAAmB,KAAKzC,aAAxB,CAAhB;AACA,WAAKwC,QAAL,CAAcE,OAAd,CAAsB,KAAK5B,cAAL,CAAoB6B,OAA1C;AACA,WAAKzD,cAAL;AACA,WAAK0D,iBAAL;AACD;AAZA,GAnBuB,EAgCvB;AACDnI,IAAAA,GAAG,EAAE,sBADJ;AAEDpB,IAAAA,KAAK,EAAE,SAASwJ,oBAAT,GAAgC;AACrC;AACAC,MAAAA,YAAY,CAAC,KAAKC,KAAN,CAAZ;AACA,WAAKA,KAAL,GAAa,IAAb,CAHqC,CAGlB;;AAEnB,WAAKP,QAAL,CAAcQ,UAAd;AACD;AARA,GAhCuB,EAyCvB;AACDvI,IAAAA,GAAG,EAAE,oBADJ;AAEDpB,IAAAA,KAAK,EAAE,SAAS4J,kBAAT,GAA8B;AACnC,WAAK/D,cAAL;AACD;AAJA,GAzCuB,EA8CvB;AACDzE,IAAAA,GAAG,EAAE,gBADJ;AAEDpB,IAAAA,KAAK,EAAE,SAAS6F,cAAT,GAA0B;AAC/B,UAAIA,cAAc,GAAG,KAAKI,KAAL,CAAWJ,cAAhC;;AAEA,UAAIA,cAAJ,EAAoB;AAClB;AACA,YAAIgE,kBAAkB,GAAG,KAAKjB,KAAL,CAAWkB,OAAX,CAAmB,oBAAnB,CAAzB;AACA,YAAIC,iBAAiB,GAAGF,kBAAkB,CAACG,oBAAnB,EAAxB;AACA,YAAIC,UAAU,GAAGF,iBAAiB,CAACzD,CAAnC;AAAA,YACI4D,SAAS,GAAGH,iBAAiB,CAACxD,CADlC;AAEA,aAAKkB,cAAL,CAAoB6B,OAApB,CAA4BW,UAA5B,GAAyCA,UAAzC;AACA,aAAKxC,cAAL,CAAoB6B,OAApB,CAA4BY,SAA5B,GAAwCA,SAAxC;AACD;AACF;AAdA,GA9CuB,EA6DvB;AACD9I,IAAAA,GAAG,EAAE,mBADJ;AAEDpB,IAAAA,KAAK,EAAE,SAASuJ,iBAAT,GAA6B;AAClC,UAAID,OAAO,GAAG,KAAK7B,cAAL,CAAoB6B,OAAlC;;AAEA,UAAIa,iBAAiB,GAAG7J,gBAAgB,CAAC,SAAD,CAAhB,CAA4B8J,MAA5B,CAAmCC,sBAAnC,CAA0Df,OAA1D,CAAxB;;AAEAA,MAAAA,OAAO,CAACgB,KAAR,CAAcC,UAAd,GAA2BJ,iBAAiB,CAAChE,KAAlB,GAA0B,IAArD;AACAmD,MAAAA,OAAO,CAACgB,KAAR,CAAcE,SAAd,GAA0BL,iBAAiB,CAAC/D,MAAlB,GAA2B,IAArD;AACD;AATA,GA7DuB,EAuEvB;AACDhF,IAAAA,GAAG,EAAE,eADJ;AAEDpB,IAAAA,KAAK,EAAE,SAAS2G,aAAT,GAAyB;AAC9B,UAAI8D,qBAAqB,GAAGnK,gBAAgB,CAAC,SAAD,CAAhB,CAA4B8J,MAA5B,CAAmCM,YAAnC,CAAgD,KAAKjD,cAAL,CAAoB6B,OAApE,CAA5B;AAAA,UACInD,KAAK,GAAGsE,qBAAqB,CAACtE,KADlC;AAAA,UAEIC,MAAM,GAAGqE,qBAAqB,CAACrE,MAFnC;;AAIA,WAAK6C,QAAL,CAAc;AACZ/C,QAAAA,YAAY,EAAE;AACZC,UAAAA,KAAK,EAAEA,KADK;AAEZC,UAAAA,MAAM,EAAEA;AAFI,SADF;AAKZP,QAAAA,cAAc,EAAE;AALJ,OAAd;AAOD;AAdA,GAvEuB,EAsFvB;AACDzE,IAAAA,GAAG,EAAE,UADJ;AAEDpB,IAAAA,KAAK,EAAE,SAAS4G,QAAT,GAAoB;AACzB,UAAI,KAAK8C,KAAL,IAAc,IAAlB,EAAwB;AACtB,aAAKA,KAAL,GAAaiB,UAAU,CAAC,KAAKlE,iBAAN,EAAyB,GAAzB,CAAvB;AACD;AACF;AANA,GAtFuB,EA6FvB;AACDrF,IAAAA,GAAG,EAAE,mBADJ;AAEDpB,IAAAA,KAAK,EAAE,SAASyG,iBAAT,GAA6B;AAClCgD,MAAAA,YAAY,CAAC,KAAKC,KAAN,CAAZ;AACA,WAAKA,KAAL,GAAa,IAAb;AACA,UAAIkB,qBAAqB,GAAG,KAAKnD,cAAL,CAAoB6B,OAAhD;AAAA,UACIY,SAAS,GAAGU,qBAAqB,CAACV,SADtC;AAAA,UAEID,UAAU,GAAGW,qBAAqB,CAACX,UAFvC;AAGA,WAAKhB,QAAL,CAAc;AACZ5C,QAAAA,eAAe,EAAE;AACfC,UAAAA,CAAC,EAAEuE,IAAI,CAACC,KAAL,CAAWb,UAAX,CADY;AAEf1D,UAAAA,CAAC,EAAEsE,IAAI,CAACC,KAAL,CAAWZ,SAAX;AAFY,SADL;AAKZrE,QAAAA,cAAc,EAAE;AALJ,OAAd;AAOD;AAfA,GA7FuB,EA6GvB;AACDzE,IAAAA,GAAG,EAAE,aADJ;AAEDpB,IAAAA,KAAK,EAAE,SAAS6G,WAAT,CAAqBkE,KAArB,EAA4B;AACjC,UAAIhB,iBAAiB,GAAGzJ,gBAAgB,CAAC,SAAD,CAAhB,CAA4B8J,MAA5B,CAAmCY,gBAAnC,CAAoD,KAAKrD,aAAL,CAAmB2B,OAAvE,CAAxB;AAAA,UACIhD,CAAC,GAAGyE,KAAK,CAACE,KAAN,GAAclB,iBAAiB,CAACmB,IADxC;AAAA,UAEI3E,CAAC,GAAGwE,KAAK,CAACI,KAAN,GAAcpB,iBAAiB,CAACqB,GAFxC;AAAA,UAGIC,mBAAmB,GAAG,KAAKzC,KAAL,CAAWkB,OAAX,CAAmB,qBAAnB,CAH1B;AAAA,UAIIwB,uBAAuB,GAAG,KAAK1C,KAAL,CAAWkB,OAAX,CAAmB,yBAAnB,CAJ9B;;AAMA,UAAIwB,uBAAuB,CAACC,mBAAxB,EAAJ,EAAmD;AACjD,YAAIC,MAAM,GAAGH,mBAAmB,CAACI,2BAApB,CAAgDnF,CAAhD,EAAmDC,CAAnD,EAAsD+E,uBAAuB,CAACI,gBAAxB,EAAtD,CAAb;AACA,aAAKC,gBAAL,CAAsBZ,KAAtB,EAA6BS,MAA7B;AACD;AACF;AAbA,GA7GuB,EA2HvB;AACDpK,IAAAA,GAAG,EAAE,cADJ;AAEDpB,IAAAA,KAAK,EAAE,SAASqH,YAAT,CAAsBuE,aAAtB,EAAqCC,aAArC,EAAoDC,IAApD,EAA0D;AAC/D,UAAIC,MAAM,GAAG,IAAI,KAAKrG,SAAL,CAAesG,SAAnB,EAAb;AAAA,UACIC,oBAAoB,GAAG,KAAKrD,KAAL,CAAWkB,OAAX,CAAmB,sBAAnB,CAD3B;AAAA,UAEIoC,gBAAgB,GAAG,KAAKtD,KAAL,CAAWkB,OAAX,CAAmB,kBAAnB,CAFvB;AAAA,UAGIqC,aAAa,GAAGF,oBAAoB,CAACG,SAArB,CAA+BR,aAA/B,CAHpB;AAAA,UAIIS,aAAa,GAAGJ,oBAAoB,CAACG,SAArB,CAA+BP,aAA/B,CAJpB;AAAA,UAKIS,YALJ;AAAA,UAMIC,MANJ;AAAA,UAOIC,WAPJ;;AASA,UAAIL,aAAa,IAAIA,aAAa,CAACM,EAAd,IAAoB,IAAzC,EAA+C;AAC7CV,QAAAA,MAAM,CAACW,UAAP,GAAoBP,aAApB;AACD;;AAED,UAAIE,aAAa,IAAIA,aAAa,CAACI,EAAd,IAAoB,IAAzC,EAA+C;AAC7CV,QAAAA,MAAM,CAACY,OAAP,GAAiBN,aAAjB;;AAEA,YAAIA,aAAa,CAACO,MAAd,KAAyB,IAA7B,EAAmC;AACjCb,UAAAA,MAAM,CAACc,UAAP,GAAoBZ,oBAAoB,CAACG,SAArB,CAA+BC,aAAa,CAACO,MAA7C,CAApB;AACD;;AAEDJ,QAAAA,WAAW,GAAGlM,gBAAgB,CAAC,SAAD,CAAhB,CAA4B8J,MAA5B,CAAmCY,gBAAnC,CAAoD,KAAKrD,aAAL,CAAmB2B,OAAvE,CAAd;AACAiD,QAAAA,MAAM,GAAGjM,gBAAgB,CAAC,SAAD,CAAhB,CAA4B8J,MAA5B,CAAmCY,gBAAnC,CAAoD,KAAKvD,cAAL,CAAoB6B,OAAxE,CAAT;AACAgD,QAAAA,YAAY,GAAGJ,gBAAgB,CAACY,eAAjB,CAAiCjB,aAAjC,CAAf;AACAE,QAAAA,MAAM,CAACgB,QAAP,GAAkB,IAAIzM,gBAAgB,CAAC,SAAD,CAAhB,CAA4B8J,MAA5B,CAAmC4C,IAAvC,CAA4CV,YAAY,CAACW,cAAzD,EAAyEC,SAAzE,CAAmFV,WAAW,CAACtB,IAA/F,EAAqGsB,WAAW,CAACpB,GAAjH,EAAsH8B,SAAtH,CAAgI,CAACX,MAAM,CAACrB,IAAxI,EAA8I,CAACqB,MAAM,CAACnB,GAAtJ,CAAlB;AACD;;AAED,UAAIU,IAAI,IAAI,IAAZ,EAAkB;AAChBC,QAAAA,MAAM,CAACD,IAAP,GAAcA,IAAd;AACD;;AAED,aAAOC,MAAP;AACD;AAlCA,GA3HuB,EA8JvB;AACD3K,IAAAA,GAAG,EAAE,kBADJ;AAEDpB,IAAAA,KAAK,EAAE,SAAS2L,gBAAT,CAA0BZ,KAA1B,EAAiCoC,kBAAjC,EAAqD;AAC1D,UAAIC,SAAJ;AAAA,UACIC,MAAM,GAAG,KADb;AAEA,UAAIC,WAAW,GAAG,KAAKpJ,KAAvB;AAAA,UACIqJ,mBAAmB,GAAGD,WAAW,CAACC,mBADtC;AAAA,UAEIC,kBAAkB,GAAGF,WAAW,CAACE,kBAFrC;AAGA,UAAI1H,aAAa,GAAG,KAAKG,KAAL,CAAWH,aAA/B;;AAEA,UAAIqH,kBAAkB,KAAKrH,aAA3B,EAA0C;AACxCsH,QAAAA,SAAS,GAAG,KAAK/F,YAAL,CAAkBvB,aAAlB,EAAiCqH,kBAAjC,CAAZ;;AAEA,YAAII,mBAAmB,IAAI,IAA3B,EAAiC;AAC/B,cAAI,CAACA,mBAAmB,CAACxC,KAAD,EAAQqC,SAAR,CAAxB,EAA4C;AAC1CC,YAAAA,MAAM,GAAG,IAAT;AACA,iBAAKpE,QAAL,CAAc;AACZnD,cAAAA,aAAa,EAAEqH;AADH,aAAd;AAGD;AACF,SAPD,MAOO;AACL,eAAKlE,QAAL,CAAc;AACZnD,YAAAA,aAAa,EAAEqH;AADH,WAAd;AAGD;;AAED;;AAEA,YAAI,CAACE,MAAL,EAAa;AACX,cAAIG,kBAAkB,IAAI,IAA1B,EAAgC;AAC9BA,YAAAA,kBAAkB,CAACzC,KAAD,EAAQqC,SAAR,CAAlB;AACD;AACF;AACF;AACF;AAlCA,GA9JuB,EAiMvB;AACDhM,IAAAA,GAAG,EAAE,eADJ;AAEDpB,IAAAA,KAAK,EAAE,SAASyN,aAAT,CAAuB1C,KAAvB,EAA8B2C,eAA9B,EAA+C;AACpD,UAAIN,SAAJ;AAAA,UACIC,MAAM,GAAG,KADb;AAEA,UAAIM,YAAY,GAAG,KAAKzJ,KAAxB;AAAA,UACI0J,gBAAgB,GAAGD,YAAY,CAACC,gBADpC;AAAA,UAEIC,eAAe,GAAGF,YAAY,CAACE,eAFnC;AAGA,UAAI9H,UAAU,GAAG,KAAKE,KAAL,CAAWF,UAA5B;;AAEA,UAAI2H,eAAe,KAAK3H,UAAxB,EAAoC;AAClCqH,QAAAA,SAAS,GAAG,KAAK/F,YAAL,CAAkBtB,UAAlB,EAA8B2H,eAA9B,CAAZ;;AAEA,YAAIE,gBAAgB,IAAI,IAAxB,EAA8B;AAC5B,cAAI,CAACA,gBAAgB,CAAC7C,KAAD,EAAQqC,SAAR,CAArB,EAAyC;AACvCC,YAAAA,MAAM,GAAG,IAAT;AACA,iBAAKpE,QAAL,CAAc;AACZlD,cAAAA,UAAU,EAAE2H,eADA;AAEZ7H,cAAAA,cAAc,EAAE;AAFJ,aAAd;AAID;AACF,SARD,MAQO;AACL,eAAKoD,QAAL,CAAc;AACZlD,YAAAA,UAAU,EAAE2H,eADA;AAEZ7H,YAAAA,cAAc,EAAE;AAFJ,WAAd;AAID;;AAED,YAAI,CAACwH,MAAL,EAAa;AACX,cAAIQ,eAAe,IAAI,IAAvB,EAA6B;AAC3BA,YAAAA,eAAe,CAAC9C,KAAD,EAAQqC,SAAR,CAAf;AACD;AACF;AACF;AACF;AAlCA,GAjMuB,EAoOvB;AACDhM,IAAAA,GAAG,EAAE,SADJ;AAEDpB,IAAAA,KAAK,EAAE,SAAS8G,OAAT,CAAiBiE,KAAjB,EAAwB;AAC7B,UAAIhB,iBAAiB,GAAGzJ,gBAAgB,CAAC,SAAD,CAAhB,CAA4B8J,MAA5B,CAAmCY,gBAAnC,CAAoD,KAAKrD,aAAL,CAAmB2B,OAAvE,CAAxB;AAAA,UACIhD,CAAC,GAAGyE,KAAK,CAACE,KAAN,GAAclB,iBAAiB,CAACmB,IADxC;AAAA,UAEI3E,CAAC,GAAGwE,KAAK,CAACI,KAAN,GAAcpB,iBAAiB,CAACqB,GAFxC;AAAA,UAGIC,mBAAmB,GAAG,KAAKzC,KAAL,CAAWkB,OAAX,CAAmB,qBAAnB,CAH1B;AAAA,UAIIgE,oBAAoB,GAAG,KAAKlF,KAAL,CAAWkB,OAAX,CAAmB,sBAAnB,CAJ3B;AAAA,UAKIwB,uBAAuB,GAAG,KAAK1C,KAAL,CAAWkB,OAAX,CAAmB,yBAAnB,CAL9B;AAAA,UAMI4D,eAAe,GAAGrC,mBAAmB,CAACI,2BAApB,CAAgDnF,CAAhD,EAAmDC,CAAnD,EAAsD+E,uBAAuB,CAACI,gBAAxB,EAAtD,CANtB;AAAA,UAOIjJ,MAPJ;;AASAA,MAAAA,MAAM,GAAGsI,KAAK,CAACtI,MAAf;;AAEA,UAAIiL,eAAe,KAAK,IAAxB,EAA8B;AAC5B,YAAIjL,MAAM,CAACsL,YAAP,CAAoB,MAApB,MAAgC,UAAhC,IAA8CtL,MAAM,CAACsL,YAAP,CAAoB,MAApB,MAAgC,eAAlF,EAAmG,CAAC;AACnG,SADD,MACO;AACL,cAAID,oBAAoB,CAACE,gBAArB,EAAJ,EAA6C;AAC3C,iBAAKP,aAAL,CAAmB1C,KAAnB,EAA0B2C,eAA1B;AACA,iBAAKjG,cAAL,CAAoB6B,OAApB,CAA4B2E,KAA5B;AACD;AACF;AACF;AACF;AAvBA,GApOuB,EA4PvB;AACD7M,IAAAA,GAAG,EAAE,kBADJ;AAEDpB,IAAAA,KAAK,EAAE,SAAS+G,gBAAT,CAA0BgE,KAA1B,EAAiC;AACtC,UAAImD,YAAY,GAAG,KAAKhK,KAAxB;AAAA,UACIiK,mBAAmB,GAAGD,YAAY,CAACC,mBADvC;AAAA,UAEIC,kBAAkB,GAAGF,YAAY,CAACE,kBAFtC;AAGA,UAAIpI,aAAa,GAAG,KAAKC,KAAL,CAAWD,aAA/B;AACA,UAAIqI,gBAAgB,GAAG,EAAvB;AACA,UAAI5L,MAAM,GAAGsI,KAAK,CAACtI,MAAnB;AACA,UAAI6L,MAAM,GAAG7L,MAAM,CAACsL,YAAP,CAAoB,SAApB,CAAb;AACA,UAAIQ,OAAO,GAAGxD,KAAK,CAACtI,MAAN,CAAa8L,OAA3B;AACA,UAAIlB,MAAM,GAAG,KAAb;;AAEA,UAAIiB,MAAM,IAAI,IAAd,EAAoB;AAClB,YAAIC,OAAJ,EAAa;AACXF,UAAAA,gBAAgB,GAAG,GAAGG,MAAH,CAAUtL,kBAAkB,CAAC8C,aAAD,CAA5B,EAA6C,CAACsI,MAAD,CAA7C,CAAnB;AACD,SAFD,MAEO;AACL;AACAD,UAAAA,gBAAgB,GAAGrI,aAAa,CAAC7D,MAAd,CAAqB,UAAUsK,EAAV,EAAc;AACpD,mBAAOA,EAAE,IAAI6B,MAAb;AACD,WAFkB,CAAnB,CAFK,CAID;AACL;;AAED,YAAIH,mBAAmB,IAAI,IAA3B,EAAiC;AAC/Bd,UAAAA,MAAM,GAAGc,mBAAmB,CAACpD,KAAD,EAAQ/E,aAAR,EAAuBqI,gBAAvB,CAA5B;AACD;;AAED,YAAI,CAAChB,MAAL,EAAa;AACX,eAAKpE,QAAL,CAAc;AACZjD,YAAAA,aAAa,EAAEqI;AADH,WAAd;;AAIA,cAAID,kBAAkB,IAAI,IAA1B,EAAgC;AAC9BA,YAAAA,kBAAkB,CAACrD,KAAD,EAAQ/E,aAAR,EAAuBqI,gBAAvB,CAAlB;AACD;AACF;AACF;AACF;AArCA,GA5PuB,EAkSvB;AACDjN,IAAAA,GAAG,EAAE,WADJ;AAEDpB,IAAAA,KAAK,EAAE,SAASgH,SAAT,CAAmB+D,KAAnB,EAA0B;AAC/B,UAAI0D,iBAAiB,GAAG,KAAK7F,KAAL,CAAWkB,OAAX,CAAmB,mBAAnB,CAAxB;AAAA,UACIwB,uBAAuB,GAAG,KAAK1C,KAAL,CAAWkB,OAAX,CAAmB,yBAAnB,CAD9B;AAAA,UAEI4E,cAAc,GAAG,KAAK9F,KAAL,CAAWkB,OAAX,CAAmB,gBAAnB,CAFrB;AAAA,UAGIgE,oBAAoB,GAAG,KAAKlF,KAAL,CAAWkB,OAAX,CAAmB,sBAAnB,CAH3B;AAAA,UAIIoC,gBAAgB,GAAG,KAAKtD,KAAL,CAAWkB,OAAX,CAAmB,kBAAnB,CAJvB;AAAA,UAKIuB,mBAAmB,GAAG,KAAKzC,KAAL,CAAWkB,OAAX,CAAmB,qBAAnB,CAL1B;AAAA,UAMI6E,SAAS,GAAGtD,mBAAmB,CAACuD,YAApB,EANhB;AAAA,UAOIC,cAAc,GAAG,IAPrB;AAAA,UAQIC,iBARJ;AAAA,UASIC,SAAS,GAAG,IAThB;AAAA,UAUIC,QAVJ;;AAYA,UAAI1D,uBAAuB,CAACC,mBAAxB,MAAiDuC,oBAAoB,CAACE,gBAArB,EAArD,EAA8F;AAC5Fa,QAAAA,cAAc,GAAGJ,iBAAiB,CAACQ,oBAAlB,EAAjB;;AAEA,YAAIJ,cAAc,KAAK,IAAvB,EAA6B;AAC3BA,UAAAA,cAAc,GAAGH,cAAc,CAACQ,iBAAf,EAAjB;AACD;AACF,OAND,MAMO,IAAI5D,uBAAuB,CAACC,mBAAxB,EAAJ,EAAmD;AACxDsD,QAAAA,cAAc,GAAGJ,iBAAiB,CAACQ,oBAAlB,EAAjB;AACD,OAFM,MAEA,IAAInB,oBAAoB,CAACE,gBAArB,EAAJ,EAA6C;AAClDa,QAAAA,cAAc,GAAGH,cAAc,CAACQ,iBAAf,EAAjB;AACD;;AAED,UAAIL,cAAc,IAAI,IAAtB,EAA4B;AAC1B,gBAAQ9D,KAAK,CAACoE,KAAd;AACE,eAAK,EAAL;AACE;AACA,gBAAIrB,oBAAoB,CAACE,gBAArB,EAAJ,EAA6C;AAC3C,mBAAKP,aAAL,CAAmB1C,KAAnB,EAA0B8D,cAA1B;AACA9D,cAAAA,KAAK,CAACqE,cAAN;AACA,mBAAK3H,cAAL,CAAoB6B,OAApB,CAA4B2E,KAA5B;AACD;;AAED;;AAEF,eAAK,EAAL;AACE;AACAc,YAAAA,SAAS,GAAGzO,gBAAgB,CAAC,SAAD,CAAhB,CAA4B8J,MAA5B,CAAmCiF,eAAnC,CAAmDC,MAA/D;AACA;;AAEF,eAAK,EAAL;AACE;AACAP,YAAAA,SAAS,GAAGzO,gBAAgB,CAAC,SAAD,CAAhB,CAA4B8J,MAA5B,CAAmCiF,eAAnC,CAAmDE,GAA/D;AACA;;AAEF,eAAK,EAAL;AACE;AACAR,YAAAA,SAAS,GAAGzO,gBAAgB,CAAC,SAAD,CAAhB,CAA4B8J,MAA5B,CAAmCiF,eAAnC,CAAmDG,IAA/D;AACA;;AAEF,eAAK,EAAL;AACE;AACAT,YAAAA,SAAS,GAAGzO,gBAAgB,CAAC,SAAD,CAAhB,CAA4B8J,MAA5B,CAAmCiF,eAAnC,CAAmDI,KAA/D;AACA;;AAEF;AACE;AAhCJ;;AAmCA,YAAIV,SAAS,IAAI,IAAjB,EAAuB;AACrBC,UAAAA,QAAQ,GAAG,KAAX;;AAEA,iBAAO,CAACA,QAAR,EAAkB;AAChBA,YAAAA,QAAQ,GAAG,IAAX;AACAD,YAAAA,SAAS,GAAGJ,SAAS,CAACe,cAAV,CAAyBX,SAAzB,CAAZ;AACAD,YAAAA,iBAAiB,GAAG5C,gBAAgB,CAACyD,WAAjB,CAA6Bd,cAA7B,EAA6CE,SAA7C,CAApB;;AAEA,gBAAID,iBAAiB,IAAI,IAAzB,EAA+B;AAC7B/D,cAAAA,KAAK,CAACqE,cAAN;;AAEA,kBAAI9D,uBAAuB,CAACC,mBAAxB,EAAJ,EAAmD;AACjD,qBAAKI,gBAAL,CAAsBZ,KAAtB,EAA6B+D,iBAA7B;AACD,eAFD,MAEO,IAAIhB,oBAAoB,CAACE,gBAArB,EAAJ,EAA6C;AAClD,qBAAKP,aAAL,CAAmB1C,KAAnB,EAA0B+D,iBAA1B;AACD;AACF;AACF;;AAED,eAAKrH,cAAL,CAAoB6B,OAApB,CAA4B2E,KAA5B;AACD;AACF;AACF;AArFA,GAlSuB,EAwXvB;AACD7M,IAAAA,GAAG,EAAE,cADJ;AAEDpB,IAAAA,KAAK,EAAE,SAASsH,YAAT,CAAsBsI,IAAtB,EAA4B;AACjC,UAAIC,YAAY,GAAGD,IAAI,CAACC,YAAxB;AACA,UAAIC,QAAQ,GAAG,KAAK/H,aAAL,CAAmB8H,YAAnB,CAAf;AACA,aAAOC,QAAQ,CAACxI,YAAT,CAAsBsI,IAAtB,CAAP;AACD;AANA,GAxXuB,EA+XvB;AACDxO,IAAAA,GAAG,EAAE,mBADJ;AAEDpB,IAAAA,KAAK,EAAE,SAASuH,iBAAT,CAA2BqI,IAA3B,EAAiC;AACtC,UAAIC,YAAY,GAAGD,IAAI,CAACC,YAAxB;AACA,UAAIC,QAAQ,GAAG,KAAK/H,aAAL,CAAmB8H,YAAnB,CAAf;AACA,aAAOC,QAAQ,CAACvI,iBAAT,CAA2BqI,IAA3B,CAAP;AACD;AANA,GA/XuB,EAsYvB;AACDxO,IAAAA,GAAG,EAAE,gBADJ;AAEDpB,IAAAA,KAAK,EAAE,SAASwH,cAAT,CAAwBoI,IAAxB,EAA8B;AACnC,UAAIC,YAAY,GAAGD,IAAI,CAACC,YAAxB;AACA,UAAIC,QAAQ,GAAG,KAAK/H,aAAL,CAAmB8H,YAAnB,CAAf;AACA,aAAOC,QAAQ,CAACtI,cAAT,CAAwBoI,IAAxB,CAAP;AACD;AANA,GAtYuB,EA6YvB;AACDxO,IAAAA,GAAG,EAAE,YADJ;AAEDpB,IAAAA,KAAK,EAAE,SAASiH,UAAT,GAAsB;AAC3B,UAAIrB,MAAM,GAAG,KAAK1B,KAAL,CAAW0B,MAAxB;AACA,UAAIqC,SAAS,GAAGrC,MAAM,CAACqC,SAAP,IAAoB,EAApC;AACA,UAAI8H,kBAAkB,GAAG9H,SAAS,CAAC+H,GAAV,CAAc,UAAUF,QAAV,EAAoB;AACzD,YAAIxI,YAAY,GAAGwI,QAAQ,CAACxI,YAA5B;AAAA,YACIC,iBAAiB,GAAGuI,QAAQ,CAACvI,iBADjC;AAAA,YAEIC,cAAc,GAAGsI,QAAQ,CAACtI,cAF9B;AAGA,eAAOhF,aAAa,CAAC,EAAD,EAAKsN,QAAL,EAAe;AACjCG,UAAAA,YAAY,EAAE,CAAC3I,YAAD,GAAgB,IAAhB,GAAuB,iDADJ;AAEjC4I,UAAAA,iBAAiB,EAAE,CAAC3I,iBAAD,GAAqB,IAArB,GAA4B,iDAFd;AAGjC4I,UAAAA,cAAc,EAAE,CAAC3I,cAAD,GAAkB,IAAlB,GAAyB;AAHR,SAAf,CAApB;AAKD,OATwB,CAAzB;AAUA,WAAKO,aAAL,GAAqBE,SAAS,CAACmI,MAAV,CAAiB,UAAUC,GAAV,EAAeP,QAAf,EAAyB;AAC7D,YAAIhE,IAAI,GAAGgE,QAAQ,CAAChE,IAApB;AACAuE,QAAAA,GAAG,CAACvE,IAAD,CAAH,GAAYgE,QAAZ;AACA,eAAOO,GAAP;AACD,OAJoB,EAIlB,EAJkB,CAArB;AAKA,UAAIC,WAAW,GAAG,KAAKrK,KAAvB;AAAA,UACIH,aAAa,GAAGwK,WAAW,CAACxK,aADhC;AAAA,UAEIC,UAAU,GAAGuK,WAAW,CAACvK,UAF7B;AAAA,UAGIC,aAAa,GAAGsK,WAAW,CAACtK,aAHhC;AAIA,aAAOxD,aAAa,CAAC,EAAD,EAAKoD,MAAL,EAAa;AAC/BqC,QAAAA,SAAS,EAAE8H,kBADoB;AAE/BjK,QAAAA,aAAa,EAAEA,aAFgB;AAG/BC,QAAAA,UAAU,EAAEA,UAHmB;AAI/BC,QAAAA,aAAa,EAAEA,aAJgB;AAK/BsB,QAAAA,YAAY,EAAE,KAAKA,YALY;AAM/BE,QAAAA,cAAc,EAAE,KAAKA,cANU;AAO/BD,QAAAA,iBAAiB,EAAE,KAAKA;AAPO,OAAb,CAApB;AASD;AAjCA,GA7YuB,EA+avB;AACDnG,IAAAA,GAAG,EAAE,aADJ;AAEDpB,IAAAA,KAAK,EAAE,SAASkH,WAAT,GAAuB;AAC5B,aAAO,KAAKc,QAAZ;AACD;AAJA,GA/auB,EAobvB;AACD5G,IAAAA,GAAG,EAAE,WADJ;AAEDpB,IAAAA,KAAK,EAAE,SAASmH,SAAT,GAAqB;AAC1B,UAAIoJ,YAAY,GAAG,KAAKtK,KAAxB;AAAA,UACIJ,cAAc,GAAG0K,YAAY,CAAC1K,cADlC;AAAA,UAEIK,YAAY,GAAGqK,YAAY,CAACrK,YAFhC;AAAA,UAGIG,eAAe,GAAGkK,YAAY,CAAClK,eAHnC;AAIA,aAAO;AACLmK,QAAAA,mBAAmB,EAAE3K,cADhB;AAEL4K,QAAAA,eAAe,EAAEvK,YAFZ;AAGL6D,QAAAA,iBAAiB,EAAE1D;AAHd,OAAP;AAKD;AAZA,GApbuB,EAicvB;AACDjF,IAAAA,GAAG,EAAE,WADJ;AAEDpB,IAAAA,KAAK,EAAE,SAASoH,SAAT,CAAmBU,aAAnB,EAAkC;AACvC,UAAI4I,QAAQ,GAAG5I,aAAa,CAAC4I,QAA7B;AAAA,UACIC,KAAK,GAAG7I,aAAa,CAAC6I,KAD1B;AAAA,UAEIC,WAAW,GAAG9I,aAAa,CAAC8I,WAFhC;AAAA,UAGIH,eAAe,GAAG3I,aAAa,CAAC2I,eAHpC;AAAA,UAIII,eAAe,GAAG/I,aAAa,CAAC+I,eAJpC;AAAA,UAKIC,eAAe,GAAGhJ,aAAa,CAACgJ,eALpC;AAMA;;AAEA,UAAIC,cAAc,GAAG,IAAIzQ,gBAAgB,CAAC,SAAD,CAAhB,CAA4B8J,MAA5B,CAAmC4G,IAAvC,CAA4CJ,WAA5C,CAArB;AACAG,MAAAA,cAAc,CAACJ,KAAf,CAAqB,IAAIA,KAAzB;AACA,UAAIM,mBAAmB,GAAG,IAAI3Q,gBAAgB,CAAC,SAAD,CAAhB,CAA4B8J,MAA5B,CAAmC4G,IAAvC,CAA4CP,eAA5C,CAA1B;;AAEA,UAAIC,QAAJ,EAAc;AACZ;AACAO,QAAAA,mBAAmB,GAAG,IAAI3Q,gBAAgB,CAAC,SAAD,CAAhB,CAA4B8J,MAA5B,CAAmC4G,IAAvC,CAA4CD,cAAc,CAAC5K,KAAf,GAAuB,EAAnE,EAAuE4K,cAAc,CAAC3K,MAAf,GAAwB,EAA/F,CAAtB;AACA6K,QAAAA,mBAAmB,CAACC,UAApB,CAA+BJ,eAA/B;AACAG,QAAAA,mBAAmB,CAACE,OAApB,CAA4BN,eAA5B,EAJY,CAIkC;AAC/C;;AAED,WAAK/I,aAAL,GAAqB;AACnB4I,QAAAA,QAAQ,EAAEA,QADS;AAEnBD,QAAAA,eAAe,EAAEQ,mBAFE;AAGnBF,QAAAA,cAAc,EAAEA,cAHG;AAInBJ,QAAAA,KAAK,EAAEA;AAJY,OAArB;AAMA,aAAOM,mBAAP;AACD;AA7BA,GAjcuB,EA+dvB;AACD7P,IAAAA,GAAG,EAAE,QADJ;AAEDpB,IAAAA,KAAK,EAAE,SAASoR,MAAT,GAAkB;AACvB,UAAIpJ,QAAQ,GAAG,KAAKA,QAApB;AACA,WAAKY,KAAL,CAAWyI,OAAX,CAAmB,aAAnB,EAAkC,IAAlC,EAAwC,KAAxC;AACA,UAAIC,qBAAqB,GAAG,KAAKtJ,QAAL,CAAcuJ,YAA1C;AAAA,UACIC,WAAW,GAAGF,qBAAqB,CAACE,WADxC;AAAA,UAEIC,kBAAkB,GAAGH,qBAAqB,CAACG,kBAF/C;AAGA,UAAIC,kBAAkB,GAAGF,WAAW,CAACG,IAAZ,CAAiBC,MAAjB,EAAzB;AACA,UAAIC,mBAAmB,GAAG,KAAK/J,aAA/B;AAAA,UACI4I,QAAQ,GAAGmB,mBAAmB,CAACnB,QADnC;AAAA,UAEIC,KAAK,GAAGkB,mBAAmB,CAAClB,KAFhC;AAAA,UAGIF,eAAe,GAAGoB,mBAAmB,CAACpB,eAH1C;AAAA,UAIIM,cAAc,GAAGc,mBAAmB,CAACd,cAJzC;AAKA;;AAEA,UAAIe,SAAS,GAAG,WAAWnB,KAAX,GAAmB,GAAnB,GAAyBA,KAAzB,GAAiC,GAAjD;AACA,aAAO1Q,MAAM,CAAC,SAAD,CAAN,CAAkB8R,aAAlB,CAAgC9R,MAAM,CAAC,SAAD,CAAN,CAAkB+R,QAAlD,EAA4D,IAA5D,EAAkE/R,MAAM,CAAC,SAAD,CAAN,CAAkB8R,aAAlB,CAAgC,KAAhC,EAAuC;AAC9GE,QAAAA,GAAG,EAAE,KAAKxK,cADoG;AAE9Gb,QAAAA,QAAQ,EAAE,KAAKA,QAF+F;AAG9GI,QAAAA,SAAS,EAAE,KAAKA,SAH8F;AAI9GsD,QAAAA,KAAK,EAAE9H,aAAa,CAAC;AACnBuK,UAAAA,QAAQ,EAAE,UADS;AAEnBmF,UAAAA,QAAQ,EAAE,MAFS;AAGnBC,UAAAA,uBAAuB,EAAE,OAHN;AAInBhM,UAAAA,KAAK,EAAE,MAJY;AAKnBC,UAAAA,MAAM,EAAE,MALW;AAMnBgM,UAAAA,OAAO,EAAE,KANU;AAOnBC,UAAAA,YAAY,EAAE,KAPK;AAQnBC,UAAAA,WAAW,EAAE;AARM,SAAD,EASjB5B,QAAQ,GAAGD,eAAe,CAACmB,MAAhB,EAAH,GAA8B,EATrB,CAJ0F;AAc9GW,QAAAA,QAAQ,EAAE;AAdoG,OAAvC,EAetEtS,MAAM,CAAC,SAAD,CAAN,CAAkB8R,aAAlB,CAAgC,KAAhC,EAAuC;AACxCE,QAAAA,GAAG,EAAE,KAAKtK,aAD8B;AAExCd,QAAAA,WAAW,EAAE,KAAKA,WAFsB;AAGxCC,QAAAA,OAAO,EAAE,KAAKA,OAH0B;AAIxC0L,QAAAA,QAAQ,EAAE,KAAKzL,gBAJyB;AAKxCuD,QAAAA,KAAK,EAAE9H,aAAa,CAAC;AACnBuK,UAAAA,QAAQ,EAAE,UADS;AAEnBmF,UAAAA,QAAQ,EAAE;AAFS,SAAD,EAGjBnB,cAAc,CAACa,MAAf,EAHiB;AALoB,OAAvC,EASA3R,MAAM,CAAC,SAAD,CAAN,CAAkB8R,aAAlB,CAAgC,KAAhC,EAAuC;AACxCE,QAAAA,GAAG,EAAE,KAAKrK,cAD8B;AAExC0C,QAAAA,KAAK,EAAE9H,aAAa,CAAC,EAAD,EAAKkP,kBAAL,EAAyB;AAC3C3E,UAAAA,QAAQ,EAAE,UADiC;AAE3CmF,UAAAA,QAAQ,EAAE,QAFiC;AAG3C,6BAAmB,KAHwB;AAI3C,uBAAaJ,SAJ8B;AAK3C,yBAAeA,SAL4B;;AAO3C;AACA,6BAAmBA,SARwB;;AAU3C;AACA,wBAAcA,SAX6B;;AAa3C;AACA,0BAAgBA;AAChB;;AAf2C,SAAzB;AAFoB,OAAvC,EAoBA9J,QAAQ,CAACgI,GAAT,CAAa,IAAb,EAAmB,aAAnB,EAAkC,UAAUyC,QAAV,EAAoBC,QAApB,EAA8B;AACjE,eAAOzS,MAAM,CAAC,SAAD,CAAN,CAAkB8R,aAAlB,CAAgC,KAAhC,EAAuC;AAC5C3Q,UAAAA,GAAG,EAAEqR,QADuC;AAE5CnI,UAAAA,KAAK,EAAE;AACLyC,YAAAA,QAAQ,EAAE,UADL;AAELmF,YAAAA,QAAQ,EAAE,SAFL;AAGLhH,YAAAA,IAAI,EAAE,KAHD;AAILE,YAAAA,GAAG,EAAE;AAJA;AAFqC,SAAvC,EAQJsH,QARI,CAAP;AASD,OAVE,CApBA,EA8BCjB,kBAAkB,IAAIxR,MAAM,CAAC,SAAD,CAAN,CAAkB8R,aAAlB,CAAgC,KAAhC,EAAuC;AAC/D3Q,QAAAA,GAAG,EAAE,SAD0D;AAE/DkJ,QAAAA,KAAK,EAAE;AACLyC,UAAAA,QAAQ,EAAE,UADL;AAELmF,UAAAA,QAAQ,EAAE,SAFL;AAGLhH,UAAAA,IAAI,EAAEuG,kBAAkB,CAACE,IAAnB,CAAwBrL,CAAxB,GAA4B,IAH7B;AAIL8E,UAAAA,GAAG,EAAEqG,kBAAkB,CAACE,IAAnB,CAAwBpL,CAAxB,GAA4B;AAJ5B;AAFwD,OAAvC,EAQvByB,QAAQ,CAACgI,GAAT,CAAa,IAAb,EAAmB,oBAAnB,EAAyC,UAAUyC,QAAV,EAAoBC,QAApB,EAA8B;AACxE,eAAOzS,MAAM,CAAC,SAAD,CAAN,CAAkB8R,aAAlB,CAAgC,KAAhC,EAAuC;AAC5C3Q,UAAAA,GAAG,EAAEqR,QADuC;AAE5CnI,UAAAA,KAAK,EAAE;AACLyC,YAAAA,QAAQ,EAAE,UADL;AAELmF,YAAAA,QAAQ,EAAE;AAFL;AAFqC,SAAvC,EAMJQ,QANI,CAAP;AAOD,OARE,CARuB,CA9BvB,CATA,CAfsE,CAAlE,CAAP;AAuED;AAxFA,GA/duB,CAAd,CAAZ;;AA0jBA,SAAOlN,WAAP;AACD,CAhoBD,CAgoBEvF,MAAM,CAAC0S,SAhoBT,CAFA;;AAooBA5P,eAAe,CAACyC,WAAD,EAAc,WAAd,EAA2B;AACxCK,EAAAA,cAAc,EAAEzF,UAAU,CAAC,SAAD,CAAV,CAAsBwS,IADE;AAExC;AACArF,EAAAA,mBAAmB,EAAEnN,UAAU,CAAC,SAAD,CAAV,CAAsByS,IAHH;AAIxC;AACArF,EAAAA,kBAAkB,EAAEpN,UAAU,CAAC,SAAD,CAAV,CAAsByS,IALF;AAMxC;AACAjF,EAAAA,gBAAgB,EAAExN,UAAU,CAAC,SAAD,CAAV,CAAsByS,IAPA;AAQxC;AACAhF,EAAAA,eAAe,EAAEzN,UAAU,CAAC,SAAD,CAAV,CAAsByS,IATC;AAUxC;AACA1E,EAAAA,mBAAmB,EAAE/N,UAAU,CAAC,SAAD,CAAV,CAAsByS,IAXH;AAYxC;AACAzE,EAAAA,kBAAkB,EAAEhO,UAAU,CAAC,SAAD,CAAV,CAAsByS,IAbF,CAaO;;AAbP,CAA3B,CAAf;;AAiBA9P,eAAe,CAACyC,WAAD,EAAc,cAAd,EAA8B;AAC3CK,EAAAA,cAAc,EAAE,IAD2B;AAE3C0H,EAAAA,mBAAmB,EAAE,IAFsB;AAG3CC,EAAAA,kBAAkB,EAAE,IAHuB;AAI3CI,EAAAA,gBAAgB,EAAE,IAJyB;AAK3CC,EAAAA,eAAe,EAAE,IAL0B;AAM3CM,EAAAA,mBAAmB,EAAE,IANsB;AAO3CC,EAAAA,kBAAkB,EAAE;AAPuB,CAA9B,CAAf;;AAUA,IAAI0E,QAAQ,GAAGtN,WAAf;AACAzF,OAAO,CAAC,SAAD,CAAP,GAAqB+S,QAArB","sourcesContent":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\n\nvar _react = _interopRequireWildcard(require(\"react\"));\n\nvar _propTypes = _interopRequireDefault(require(\"prop-types\"));\n\nvar _basicprimitives = _interopRequireDefault(require(\"basicprimitives\"));\n\nvar _Graphics = _interopRequireDefault(require(\"./Graphics\"));\n\nvar _Templates = require(\"./Templates\");\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\nfunction _getRequireWildcardCache() { if (typeof WeakMap !== \"function\") return null; var cache = new WeakMap(); _getRequireWildcardCache = function _getRequireWildcardCache() { return cache; }; return cache; }\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } if (obj === null || _typeof(obj) !== \"object\" && typeof obj !== \"function\") { return { \"default\": obj }; } var cache = _getRequireWildcardCache(); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj[\"default\"] = obj; if (cache) { cache.set(obj, newObj); } return newObj; }\n\nfunction _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread(); }\n\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance\"); }\n\nfunction _iterableToArray(iter) { if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === \"[object Arguments]\") return Array.from(iter); }\n\nfunction _arrayWithoutHoles(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nvar BaseDiagram =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(BaseDiagram, _Component);\n\n  function BaseDiagram(props, namespace) {\n    var _this;\n\n    _classCallCheck(this, BaseDiagram);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(BaseDiagram).call(this, props));\n    _this.namespace = namespace;\n    var config = props.config,\n        centerOnCursor = props.centerOnCursor;\n    var highlightItem = config.highlightItem,\n        cursorItem = config.cursorItem,\n        selectedItems = config.selectedItems;\n    _this.state = {\n      viewportSize: {\n        width: 0,\n        height: 0\n      },\n      contentPosition: {\n        x: 0,\n        y: 0\n      },\n      centerOnCursor: centerOnCursor,\n      highlightItem: highlightItem,\n      cursorItem: cursorItem,\n      selectedItems: (selectedItems || []).slice()\n    };\n    var viewportSize = _this.state.viewportSize;\n    _this.onRefreshViewport = _this.onRefreshViewport.bind(_assertThisInitialized(_this));\n    _this.onSizeChanged = _this.onSizeChanged.bind(_assertThisInitialized(_this));\n    _this.onScroll = _this.onScroll.bind(_assertThisInitialized(_this));\n    _this.onMouseMove = _this.onMouseMove.bind(_assertThisInitialized(_this));\n    _this.onClick = _this.onClick.bind(_assertThisInitialized(_this));\n    _this.onCheckboxChange = _this.onCheckboxChange.bind(_assertThisInitialized(_this));\n    _this.onKeyDown = _this.onKeyDown.bind(_assertThisInitialized(_this));\n    _this.getOptions = _this.getOptions.bind(_assertThisInitialized(_this));\n    _this.getGraphics = _this.getGraphics.bind(_assertThisInitialized(_this));\n    _this.getLayout = _this.getLayout.bind(_assertThisInitialized(_this));\n    _this.setLayout = _this.setLayout.bind(_assertThisInitialized(_this));\n    _this.getEventArgs = _this.getEventArgs.bind(_assertThisInitialized(_this));\n    _this.centerOnCursor = _this.centerOnCursor.bind(_assertThisInitialized(_this));\n    _this.onItemRender = _this.onItemRender.bind(_assertThisInitialized(_this));\n    _this.onHighlightRender = _this.onHighlightRender.bind(_assertThisInitialized(_this));\n    _this.onCursorRender = _this.onCursorRender.bind(_assertThisInitialized(_this));\n    _this.scrollPanelRef = _react[\"default\"].createRef();\n    _this.mousePanelRef = _react[\"default\"].createRef();\n    _this.placeholderRef = _react[\"default\"].createRef();\n    _this.calloutPlaceholderRef = _react[\"default\"].createRef();\n    _this.layoutOptions = {};\n    _this.templatesHash = {};\n    _this.graphics = new _Graphics[\"default\"](viewportSize);\n    _this.templates = {\n      AnnotationLabelTemplate: _Templates.AnnotationLabelTemplate,\n      ButtonsTemplate: _Templates.ButtonsTemplate,\n      CheckBoxTemplate: _Templates.CheckBoxTemplate,\n      CursorTemplate: _Templates.CursorTemplate,\n      DotHighlightTemplate: _Templates.DotHighlightTemplate,\n      GroupTitleTemplate: _Templates.GroupTitleTemplate,\n      HighlightTemplate: _Templates.HighlightTemplate,\n      ItemTemplate: _Templates.ItemTemplate,\n      UserTemplate: _Templates.UserTemplate,\n      LabelAnnotationTemplate: _Templates.LabelAnnotationTemplate\n    };\n    _this.tasks = namespace.TaskManagerFactory(_this.getOptions, _this.getGraphics, _this.getLayout, _this.setLayout, _this.templates);\n    return _this;\n  }\n\n  _createClass(BaseDiagram, [{\n    key: \"componentWillReceiveProps\",\n    value: function componentWillReceiveProps(nextProps) {\n      var nextConfig = nextProps.config,\n          centerOnCursor = nextProps.centerOnCursor;\n      var config = this.props.config;\n\n      if (config !== nextConfig) {\n        var highlightItem = nextConfig.highlightItem,\n            cursorItem = nextConfig.cursorItem,\n            selectedItems = nextConfig.selectedItems;\n        this.setState({\n          highlightItem: highlightItem,\n          cursorItem: cursorItem,\n          selectedItems: (selectedItems || []).slice(),\n          centerOnCursor: centerOnCursor\n        });\n      }\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      // The following code is ResizeObserver Polyfill\n      // It is added to the rendered page to track size changes of control placeholder\n      // npm install resize-observer-polyfill --save-dev\n      require('resize-observer-polyfill/dist/ResizeObserver.global');\n\n      this.observer = new ResizeObserver(this.onSizeChanged);\n      this.observer.observe(this.scrollPanelRef.current);\n      this.centerOnCursor();\n      this.fixPixelAlignment();\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      // destroy timer\n      clearTimeout(this.timer);\n      this.timer = null; // destroy observer\n\n      this.observer.disconnect();\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate() {\n      this.centerOnCursor();\n    }\n  }, {\n    key: \"centerOnCursor\",\n    value: function centerOnCursor() {\n      var centerOnCursor = this.state.centerOnCursor;\n\n      if (centerOnCursor) {\n        /* scroll to offset */\n        var centerOnCursorTask = this.tasks.getTask(\"CenterOnCursorTask\");\n        var placeholderOffset = centerOnCursorTask.getPlaceholderOffset();\n        var scrollLeft = placeholderOffset.x,\n            scrollTop = placeholderOffset.y;\n        this.scrollPanelRef.current.scrollLeft = scrollLeft;\n        this.scrollPanelRef.current.scrollTop = scrollTop;\n      }\n    }\n  }, {\n    key: \"fixPixelAlignment\",\n    value: function fixPixelAlignment() {\n      var current = this.scrollPanelRef.current;\n\n      var pixelAlignmentFix = _basicprimitives[\"default\"].common.getFixOfPixelALignment(current);\n\n      current.style.marginLeft = pixelAlignmentFix.width + \"px\";\n      current.style.marginTop = pixelAlignmentFix.height + \"px\";\n    }\n  }, {\n    key: \"onSizeChanged\",\n    value: function onSizeChanged() {\n      var _primitives$common$ge = _basicprimitives[\"default\"].common.getInnerSize(this.scrollPanelRef.current),\n          width = _primitives$common$ge.width,\n          height = _primitives$common$ge.height;\n\n      this.setState({\n        viewportSize: {\n          width: width,\n          height: height\n        },\n        centerOnCursor: true\n      });\n    }\n  }, {\n    key: \"onScroll\",\n    value: function onScroll() {\n      if (this.timer == null) {\n        this.timer = setTimeout(this.onRefreshViewport, 200);\n      }\n    }\n  }, {\n    key: \"onRefreshViewport\",\n    value: function onRefreshViewport() {\n      clearTimeout(this.timer);\n      this.timer = null;\n      var _this$scrollPanelRef$ = this.scrollPanelRef.current,\n          scrollTop = _this$scrollPanelRef$.scrollTop,\n          scrollLeft = _this$scrollPanelRef$.scrollLeft;\n      this.setState({\n        contentPosition: {\n          x: Math.floor(scrollLeft),\n          y: Math.floor(scrollTop)\n        },\n        centerOnCursor: false\n      });\n    }\n  }, {\n    key: \"onMouseMove\",\n    value: function onMouseMove(event) {\n      var placeholderOffset = _basicprimitives[\"default\"].common.getElementOffset(this.mousePanelRef.current),\n          x = event.pageX - placeholderOffset.left,\n          y = event.pageY - placeholderOffset.top,\n          createTransformTask = this.tasks.getTask(\"CreateTransformTask\"),\n          highlightItemOptionTask = this.tasks.getTask(\"HighlightItemOptionTask\");\n\n      if (highlightItemOptionTask.hasHighlightEnabled()) {\n        var itemId = createTransformTask.getTreeItemForMousePosition(x, y, highlightItemOptionTask.getGravityRadius());\n        this.setHighlightItem(event, itemId);\n      }\n    }\n  }, {\n    key: \"getEventArgs\",\n    value: function getEventArgs(oldTreeItemId, newTreeItemId, name) {\n      var result = new this.namespace.EventArgs(),\n          combinedContextsTask = this.tasks.getTask(\"CombinedContextsTask\"),\n          alignDiagramTask = this.tasks.getTask(\"AlignDiagramTask\"),\n          oldItemConfig = combinedContextsTask.getConfig(oldTreeItemId),\n          newItemConfig = combinedContextsTask.getConfig(newTreeItemId),\n          itemPosition,\n          offset,\n          panelOffset;\n\n      if (oldItemConfig && oldItemConfig.id != null) {\n        result.oldContext = oldItemConfig;\n      }\n\n      if (newItemConfig && newItemConfig.id != null) {\n        result.context = newItemConfig;\n\n        if (newItemConfig.parent !== null) {\n          result.parentItem = combinedContextsTask.getConfig(newItemConfig.parent);\n        }\n\n        panelOffset = _basicprimitives[\"default\"].common.getElementOffset(this.mousePanelRef.current);\n        offset = _basicprimitives[\"default\"].common.getElementOffset(this.scrollPanelRef.current);\n        itemPosition = alignDiagramTask.getItemPosition(newTreeItemId);\n        result.position = new _basicprimitives[\"default\"].common.Rect(itemPosition.actualPosition).translate(panelOffset.left, panelOffset.top).translate(-offset.left, -offset.top);\n      }\n\n      if (name != null) {\n        result.name = name;\n      }\n\n      return result;\n    }\n  }, {\n    key: \"setHighlightItem\",\n    value: function setHighlightItem(event, newHighlightItemId) {\n      var eventArgs,\n          cancel = false;\n      var _this$props = this.props,\n          onHighlightChanging = _this$props.onHighlightChanging,\n          onHighlightChanged = _this$props.onHighlightChanged;\n      var highlightItem = this.state.highlightItem;\n\n      if (newHighlightItemId !== highlightItem) {\n        eventArgs = this.getEventArgs(highlightItem, newHighlightItemId);\n\n        if (onHighlightChanging != null) {\n          if (!onHighlightChanging(event, eventArgs)) {\n            cancel = true;\n            this.setState({\n              highlightItem: newHighlightItemId\n            });\n          }\n        } else {\n          this.setState({\n            highlightItem: newHighlightItemId\n          });\n        }\n\n        ;\n\n        if (!cancel) {\n          if (onHighlightChanged != null) {\n            onHighlightChanged(event, eventArgs);\n          }\n        }\n      }\n    }\n  }, {\n    key: \"setCursorItem\",\n    value: function setCursorItem(event, newCursorItemId) {\n      var eventArgs,\n          cancel = false;\n      var _this$props2 = this.props,\n          onCursorChanging = _this$props2.onCursorChanging,\n          onCursorChanged = _this$props2.onCursorChanged;\n      var cursorItem = this.state.cursorItem;\n\n      if (newCursorItemId !== cursorItem) {\n        eventArgs = this.getEventArgs(cursorItem, newCursorItemId);\n\n        if (onCursorChanging != null) {\n          if (!onCursorChanging(event, eventArgs)) {\n            cancel = true;\n            this.setState({\n              cursorItem: newCursorItemId,\n              centerOnCursor: true\n            });\n          }\n        } else {\n          this.setState({\n            cursorItem: newCursorItemId,\n            centerOnCursor: true\n          });\n        }\n\n        if (!cancel) {\n          if (onCursorChanged != null) {\n            onCursorChanged(event, eventArgs);\n          }\n        }\n      }\n    }\n  }, {\n    key: \"onClick\",\n    value: function onClick(event) {\n      var placeholderOffset = _basicprimitives[\"default\"].common.getElementOffset(this.mousePanelRef.current),\n          x = event.pageX - placeholderOffset.left,\n          y = event.pageY - placeholderOffset.top,\n          createTransformTask = this.tasks.getTask(\"CreateTransformTask\"),\n          cursorItemOptionTask = this.tasks.getTask(\"CursorItemOptionTask\"),\n          highlightItemOptionTask = this.tasks.getTask(\"HighlightItemOptionTask\"),\n          newCursorItemId = createTransformTask.getTreeItemForMousePosition(x, y, highlightItemOptionTask.getGravityRadius()),\n          target;\n\n      target = event.target;\n\n      if (newCursorItemId !== null) {\n        if (target.getAttribute(\"name\") === \"checkbox\" || target.getAttribute(\"name\") === \"selectiontext\") {//ignore jslint\n        } else {\n          if (cursorItemOptionTask.hasCursorEnabled()) {\n            this.setCursorItem(event, newCursorItemId);\n            this.scrollPanelRef.current.focus();\n          }\n        }\n      }\n    }\n  }, {\n    key: \"onCheckboxChange\",\n    value: function onCheckboxChange(event) {\n      var _this$props3 = this.props,\n          onSelectionChanging = _this$props3.onSelectionChanging,\n          onSelectionChanged = _this$props3.onSelectionChanged;\n      var selectedItems = this.state.selectedItems;\n      var newSelectedItems = [];\n      var target = event.target;\n      var itemid = target.getAttribute(\"data-id\");\n      var checked = event.target.checked;\n      var cancel = false;\n\n      if (itemid != null) {\n        if (checked) {\n          newSelectedItems = [].concat(_toConsumableArray(selectedItems), [itemid]);\n        } else {\n          // eslint-disable-next-line\n          newSelectedItems = selectedItems.filter(function (id) {\n            return id != itemid;\n          }); // User type may not mach string value in data attribute\n        }\n\n        if (onSelectionChanging != null) {\n          cancel = onSelectionChanging(event, selectedItems, newSelectedItems);\n        }\n\n        if (!cancel) {\n          this.setState({\n            selectedItems: newSelectedItems\n          });\n\n          if (onSelectionChanged != null) {\n            onSelectionChanged(event, selectedItems, newSelectedItems);\n          }\n        }\n      }\n    }\n  }, {\n    key: \"onKeyDown\",\n    value: function onKeyDown(event) {\n      var highlightItemTask = this.tasks.getTask(\"HighlightItemTask\"),\n          highlightItemOptionTask = this.tasks.getTask(\"HighlightItemOptionTask\"),\n          cursorItemTask = this.tasks.getTask(\"CursorItemTask\"),\n          cursorItemOptionTask = this.tasks.getTask(\"CursorItemOptionTask\"),\n          alignDiagramTask = this.tasks.getTask('AlignDiagramTask'),\n          createTransformTask = this.tasks.getTask('CreateTransformTask'),\n          transform = createTransformTask.getTransform(),\n          navigationItem = null,\n          newNavigationItem,\n          direction = null,\n          accepted;\n\n      if (highlightItemOptionTask.hasHighlightEnabled() && cursorItemOptionTask.hasCursorEnabled()) {\n        navigationItem = highlightItemTask.getHighlightTreeItem();\n\n        if (navigationItem === null) {\n          navigationItem = cursorItemTask.getCursorTreeItem();\n        }\n      } else if (highlightItemOptionTask.hasHighlightEnabled()) {\n        navigationItem = highlightItemTask.getHighlightTreeItem();\n      } else if (cursorItemOptionTask.hasCursorEnabled()) {\n        navigationItem = cursorItemTask.getCursorTreeItem();\n      }\n\n      if (navigationItem != null) {\n        switch (event.which) {\n          case 13:\n            /*Enter*/\n            if (cursorItemOptionTask.hasCursorEnabled()) {\n              this.setCursorItem(event, navigationItem);\n              event.preventDefault();\n              this.scrollPanelRef.current.focus();\n            }\n\n            break;\n\n          case 40:\n            /*Down*/\n            direction = _basicprimitives[\"default\"].common.OrientationType.Bottom;\n            break;\n\n          case 38:\n            /*Up*/\n            direction = _basicprimitives[\"default\"].common.OrientationType.Top;\n            break;\n\n          case 37:\n            /*Left*/\n            direction = _basicprimitives[\"default\"].common.OrientationType.Left;\n            break;\n\n          case 39:\n            /*Right*/\n            direction = _basicprimitives[\"default\"].common.OrientationType.Right;\n            break;\n\n          default:\n            break;\n        }\n\n        if (direction != null) {\n          accepted = false;\n\n          while (!accepted) {\n            accepted = true;\n            direction = transform.getOrientation(direction);\n            newNavigationItem = alignDiagramTask.getNextItem(navigationItem, direction);\n\n            if (newNavigationItem != null) {\n              event.preventDefault();\n\n              if (highlightItemOptionTask.hasHighlightEnabled()) {\n                this.setHighlightItem(event, newNavigationItem);\n              } else if (cursorItemOptionTask.hasCursorEnabled()) {\n                this.setCursorItem(event, newNavigationItem);\n              }\n            }\n          }\n\n          this.scrollPanelRef.current.focus();\n        }\n      }\n    }\n  }, {\n    key: \"onItemRender\",\n    value: function onItemRender(data) {\n      var templateName = data.templateName;\n      var template = this.templatesHash[templateName];\n      return template.onItemRender(data);\n    }\n  }, {\n    key: \"onHighlightRender\",\n    value: function onHighlightRender(data) {\n      var templateName = data.templateName;\n      var template = this.templatesHash[templateName];\n      return template.onHighlightRender(data);\n    }\n  }, {\n    key: \"onCursorRender\",\n    value: function onCursorRender(data) {\n      var templateName = data.templateName;\n      var template = this.templatesHash[templateName];\n      return template.onCursorRender(data);\n    }\n  }, {\n    key: \"getOptions\",\n    value: function getOptions() {\n      var config = this.props.config;\n      var templates = config.templates || [];\n      var effectiveTemplates = templates.map(function (template) {\n        var onItemRender = template.onItemRender,\n            onHighlightRender = template.onHighlightRender,\n            onCursorRender = template.onCursorRender;\n        return _objectSpread({}, template, {\n          itemTemplate: !onItemRender ? null : \"<p>This template is not being used in React</p>\",\n          highlightTemplate: !onHighlightRender ? null : \"<p>This template is not being used in React</p>\",\n          cursorTemplate: !onCursorRender ? null : \"<p>This template is not being used in React</p>\"\n        });\n      });\n      this.templatesHash = templates.reduce(function (agg, template) {\n        var name = template.name;\n        agg[name] = template;\n        return agg;\n      }, {});\n      var _this$state = this.state,\n          highlightItem = _this$state.highlightItem,\n          cursorItem = _this$state.cursorItem,\n          selectedItems = _this$state.selectedItems;\n      return _objectSpread({}, config, {\n        templates: effectiveTemplates,\n        highlightItem: highlightItem,\n        cursorItem: cursorItem,\n        selectedItems: selectedItems,\n        onItemRender: this.onItemRender,\n        onCursorRender: this.onCursorRender,\n        onHighlightRender: this.onHighlightRender\n      });\n    }\n  }, {\n    key: \"getGraphics\",\n    value: function getGraphics() {\n      return this.graphics;\n    }\n  }, {\n    key: \"getLayout\",\n    value: function getLayout() {\n      var _this$state2 = this.state,\n          centerOnCursor = _this$state2.centerOnCursor,\n          viewportSize = _this$state2.viewportSize,\n          contentPosition = _this$state2.contentPosition;\n      return {\n        forceCenterOnCursor: centerOnCursor,\n        scrollPanelSize: viewportSize,\n        placeholderOffset: contentPosition\n      };\n    }\n  }, {\n    key: \"setLayout\",\n    value: function setLayout(layoutOptions) {\n      var autoSize = layoutOptions.autoSize,\n          scale = layoutOptions.scale,\n          contentSize = layoutOptions.contentSize,\n          scrollPanelSize = layoutOptions.scrollPanelSize,\n          autoSizeMinimum = layoutOptions.autoSizeMinimum,\n          autoSizeMaximum = layoutOptions.autoSizeMaximum;\n      /* set size of panel with content */\n\n      var mousePanelSize = new _basicprimitives[\"default\"].common.Size(contentSize);\n      mousePanelSize.scale(1 * scale);\n      var scrollPanelAutoSize = new _basicprimitives[\"default\"].common.Size(scrollPanelSize);\n\n      if (autoSize) {\n        /* resize element to fit placeholder if control in autosize mode */\n        scrollPanelAutoSize = new _basicprimitives[\"default\"].common.Size(mousePanelSize.width + 25, mousePanelSize.height + 25);\n        scrollPanelAutoSize.cropBySize(autoSizeMaximum);\n        scrollPanelAutoSize.addSize(autoSizeMinimum); //ignore jslint\n      }\n\n      this.layoutOptions = {\n        autoSize: autoSize,\n        scrollPanelSize: scrollPanelAutoSize,\n        mousePanelSize: mousePanelSize,\n        scale: scale\n      };\n      return scrollPanelAutoSize;\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var graphics = this.graphics;\n      this.tasks.process('OptionsTask', null, false);\n      var _this$graphics$placeh = this.graphics.placeholders,\n          placeholder = _this$graphics$placeh.placeholder,\n          calloutplaceholder = _this$graphics$placeh.calloutplaceholder;\n      var placeholderRectCSS = placeholder.rect.getCSS();\n      var _this$layoutOptions = this.layoutOptions,\n          autoSize = _this$layoutOptions.autoSize,\n          scale = _this$layoutOptions.scale,\n          scrollPanelSize = _this$layoutOptions.scrollPanelSize,\n          mousePanelSize = _this$layoutOptions.mousePanelSize;\n      /* set CSS scale of content */\n\n      var scaletext = \"scale(\" + scale + \",\" + scale + \")\";\n      return _react[\"default\"].createElement(_react[\"default\"].Fragment, null, _react[\"default\"].createElement(\"div\", {\n        ref: this.scrollPanelRef,\n        onScroll: this.onScroll,\n        onKeyDown: this.onKeyDown,\n        style: _objectSpread({\n          position: \"relative\",\n          overflow: \"auto\",\n          WebkitOverflowScrolling: \"touch\",\n          width: \"100%\",\n          height: \"100%\",\n          padding: \"0px\",\n          marginBottom: \"0px\",\n          marginRight: \"0px\"\n        }, autoSize ? scrollPanelSize.getCSS() : {}),\n        tabIndex: \"0\"\n      }, _react[\"default\"].createElement(\"div\", {\n        ref: this.mousePanelRef,\n        onMouseMove: this.onMouseMove,\n        onClick: this.onClick,\n        onChange: this.onCheckboxChange,\n        style: _objectSpread({\n          position: \"absolute\",\n          overflow: \"hidden\"\n        }, mousePanelSize.getCSS())\n      }, _react[\"default\"].createElement(\"div\", {\n        ref: this.placeholderRef,\n        style: _objectSpread({}, placeholderRectCSS, {\n          position: \"absolute\",\n          overflow: \"hidden\",\n          \"transformOrigin\": \"0 0\",\n          \"transform\": scaletext,\n          \"msTransform\": scaletext,\n\n          /* IE 9 */\n          \"WebkitTransform\": scaletext,\n\n          /* Safari and Chrome */\n          \"OTransform\": scaletext,\n\n          /* Opera */\n          \"MozTransform\": scaletext\n          /* Firefox */\n\n        })\n      }, graphics.map(this, \"placeholder\", function (layerKey, elements) {\n        return _react[\"default\"].createElement(\"div\", {\n          key: layerKey,\n          style: {\n            position: \"absolute\",\n            overflow: \"visible\",\n            left: \"0px\",\n            top: \"0px\"\n          }\n        }, elements);\n      }), calloutplaceholder && _react[\"default\"].createElement(\"div\", {\n        key: \"Callout\",\n        style: {\n          position: \"absolute\",\n          overflow: \"visible\",\n          left: calloutplaceholder.rect.x + \"px\",\n          top: calloutplaceholder.rect.y + \"px\"\n        }\n      }, graphics.map(this, \"calloutplaceholder\", function (layerKey, elements) {\n        return _react[\"default\"].createElement(\"div\", {\n          key: layerKey,\n          style: {\n            position: \"absolute\",\n            overflow: \"visible\"\n          }\n        }, elements);\n      }))))));\n    }\n  }]);\n\n  return BaseDiagram;\n}(_react.Component);\n\n_defineProperty(BaseDiagram, \"propTypes\", {\n  centerOnCursor: _propTypes[\"default\"].bool,\n  // eslint-disable-line react/no-unused-prop-types\n  onHighlightChanging: _propTypes[\"default\"].func,\n  // eslint-disable-line react/no-unused-prop-types\n  onHighlightChanged: _propTypes[\"default\"].func,\n  // eslint-disable-line react/no-unused-prop-types\n  onCursorChanging: _propTypes[\"default\"].func,\n  // eslint-disable-line react/no-unused-prop-types\n  onCursorChanged: _propTypes[\"default\"].func,\n  // eslint-disable-line react/no-unused-prop-types\n  onSelectionChanging: _propTypes[\"default\"].func,\n  // eslint-disable-line react/no-unused-prop-types\n  onSelectionChanged: _propTypes[\"default\"].func // eslint-disable-line react/no-unused-prop-types\n\n});\n\n_defineProperty(BaseDiagram, \"defaultProps\", {\n  centerOnCursor: true,\n  onHighlightChanging: null,\n  onHighlightChanged: null,\n  onCursorChanging: null,\n  onCursorChanged: null,\n  onSelectionChanging: null,\n  onSelectionChanged: null\n});\n\nvar _default = BaseDiagram;\nexports[\"default\"] = _default;"]},"metadata":{},"sourceType":"script"}